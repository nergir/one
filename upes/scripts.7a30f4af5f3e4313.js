(function(D,N){"object"==typeof exports&&typeof module<"u"?module.exports=N():"function"==typeof define&&define.amd?define(N):D.proj4=N()})(this,function(){"use strict";function D(t,i){if(t[i])return t[i];for(var e,n=Object.keys(t),a=i.toLowerCase().replace(mi,""),h=-1;++h<n.length;)if((e=n[h]).toLowerCase().replace(mi,"")===a)return t[e]}function N(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=bt}function b(t,i,e){Array.isArray(i)&&(e.unshift(i),i=null);var a=e.reduce(function(h,l){return s(l,h),h},i?{}:t);i&&(t[i]=a)}function s(t,i){if(Array.isArray(t)){var e=t.shift();if("PARAMETER"===e&&(e=t.shift()),1===t.length)return Array.isArray(t[0])?(i[e]={},void s(t[0],i[e])):void(i[e]=t[0]);if(t.length)if("TOWGS84"!==e){if("AXIS"===e)return e in i||(i[e]=[]),void i[e].push(t);var n;switch(Array.isArray(e)||(i[e]={}),e){case"UNIT":case"PRIMEM":case"VERT_DATUM":return i[e]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&s(t[2],i[e]));case"SPHEROID":case"ELLIPSOID":return i[e]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&s(t[3],i[e]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void b(i,e,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return s(t,i[e]);return b(i,e,t)}}else i[e]=t;else i[e]=!0}else i[t]=!0}function c(t){return t*ve}function g(t){var i=this;if(2===arguments.length){var e=arguments[1];g[t]="string"==typeof e?"+"===e.charAt(0)?Kt(arguments[1]):gi(arguments[1]):e}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(n){Array.isArray(n)?g.apply(i,n):g(n)});if("string"==typeof t){if(t in g)return g[t]}else"EPSG"in t?g["EPSG:"+t.EPSG]=t:"ESRI"in t?g["ESRI:"+t.ESRI]=t:"IAU2000"in t?g["IAU2000:"+t.IAU2000]=t:console.log(t);return}}function si(t){return t}function ai(t,i){var e=qt.length;return t.names?(qt[e]=t,t.names.forEach(function(n){Ut[n.toLowerCase()]=e}),this):(console.log(i),!0)}function ji(t){if(0===t.length)return null;var i="@"===t[0];return i&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!i,grid:null,isNull:!0}:{name:t,mandatory:!i,grid:yi[t]||null,isNull:!1}}function dt(t){return t/3600*Math.PI/180}function Wt(t,i,e){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(i,e)))}function Qi(t,i,e){for(var n=[],a=0;a<i.nSubgrids;a++){var h=Xi(t,176,e),l=Yi(t,176,h,e),r=Math.round(1+(h.upperLongitude-h.lowerLongitude)/h.longitudeInterval),d=Math.round(1+(h.upperLatitude-h.lowerLatitude)/h.latitudeInterval);n.push({ll:[dt(h.lowerLongitude),dt(h.lowerLatitude)],del:[dt(h.longitudeInterval),dt(h.latitudeInterval)],lim:[r,d],count:h.gridNodeCount,cvs:Wi(l)})}return n}function Wi(t){return t.map(function(i){return[dt(i.longitudeShift),dt(i.latitudeShift)]})}function Xi(t,i,e){return{name:Wt(t,i+8,i+16).trim(),parent:Wt(t,i+24,i+24+8).trim(),lowerLatitude:t.getFloat64(i+72,e),upperLatitude:t.getFloat64(i+88,e),lowerLongitude:t.getFloat64(i+104,e),upperLongitude:t.getFloat64(i+120,e),latitudeInterval:t.getFloat64(i+136,e),longitudeInterval:t.getFloat64(i+152,e),gridNodeCount:t.getInt32(i+168,e)}}function Yi(t,i,e,n){for(var a=i+176,h=[],l=0;l<e.gridNodeCount;l++){var r={latitudeShift:t.getFloat32(a+16*l,n),longitudeShift:t.getFloat32(a+16*l+4,n),latitudeAccuracy:t.getFloat32(a+16*l+8,n),longitudeAccuracy:t.getFloat32(a+16*l+12,n)};h.push(r)}return h}function it(t,i){if(!(this instanceof it))return new it(t);i=i||function(u){if(u)throw u};var e=function zi(t){if(!function w(t){return"string"==typeof t}(t))return t;if(function T(t){return t in g}(t))return g[t];if(function I(t){return be.some(function(i){return t.indexOf(i)>-1})}(t)){var i=gi(t);if(function H(t){var i=D(t,"authority");if(i){var e=D(i,"epsg");return e&&we.indexOf(e)>-1}}(i))return g["EPSG:3857"];var e=function Ri(t){var i=D(t,"extension");if(i)return D(i,"proj4")}(i);return e?Kt(e):i}return function Gi(t){return"+"===t[0]}(t)?Kt(t):void 0}(t);if("object"==typeof e){var n=it.projections.get(e.projName);if(n){if(e.datumCode&&"none"!==e.datumCode){var a=D(F,e.datumCode);a&&(e.datum_params=e.datum_params||(a.towgs84?a.towgs84.split(","):null),e.ellps=a.ellipse,e.datumName=a.datumName?a.datumName:e.datumCode)}e.k0=e.k0||1,e.axis=e.axis||"enu",e.ellps=e.ellps||"wgs84",e.lat1=e.lat1||e.lat0;var h=function qi(t,i,e,n,a){if(!t){var h=D(S,n);h||(h=ke),t=h.a,i=h.b,e=h.rf}return e&&!i&&(i=(1-1/e)*t),(0===e||Math.abs(t-i)<k)&&(a=!0,i=t),{a:t,b:i,rf:e,sphere:a}}(e.a,e.b,e.rf,e.ellps,e.sphere),l=function Ui(t,i,e,n){var a=t*t,h=i*i,l=(a-h)/a,r=0;return n?(a=(t*=1-l*(_e+l*(fe+l*me)))*t,l=0):r=Math.sqrt(l),{es:l,e:r,ep2:(a-h)/h}}(h.a,h.b,0,e.R_A),r=function Hi(t){return void 0===t?null:t.split(",").map(ji)}(e.nadgrids),d=e.datum||function Bi(t,i,e,n,a,h,l){var r={};return r.datum_type=void 0===t||"none"===t?Zt:pe,i&&(r.datum_params=i.map(parseFloat),0===r.datum_params[0]&&0===r.datum_params[1]&&0===r.datum_params[2]||(r.datum_type=lt),r.datum_params.length>3&&(0===r.datum_params[3]&&0===r.datum_params[4]&&0===r.datum_params[5]&&0===r.datum_params[6]||(r.datum_type=ct,r.datum_params[3]*=yt,r.datum_params[4]*=yt,r.datum_params[5]*=yt,r.datum_params[6]=r.datum_params[6]/1e6+1))),l&&(r.datum_type=Gt,r.grids=l),r.a=e,r.b=n,r.es=a,r.ep2=h,r}(e.datumCode,e.datum_params,h.a,h.b,l.es,l.ep2,r);Li(this,e),Li(this,n),this.a=h.a,this.b=h.b,this.rf=h.rf,this.sphere=h.sphere,this.es=l.es,this.e=l.e,this.ep2=l.ep2,this.datum=d,this.init(),i(null,this)}else i(t)}else i(t)}function oi(t,i,e){var n,a,l,r=t.x,d=t.y,u=t.z?t.z:0;if(d<-y&&d>-1.001*y)d=-y;else if(d>y&&d<1.001*y)d=y;else{if(d<-y)return{x:-1/0,y:-1/0,z:t.z};if(d>y)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),a=Math.sin(d),l=Math.cos(d),{x:((n=e/Math.sqrt(1-i*(a*a)))+u)*l*Math.cos(r),y:(n+u)*l*Math.sin(r),z:(n*(1-i)+u)*a}}function ni(t,i,e,n){var a,h,l,r,d,u,p,_,m,v,M,x,A,P,O,B=t.x,Q=t.y,j=t.z?t.z:0;if(a=Math.sqrt(B*B+Q*Q),h=Math.sqrt(B*B+Q*Q+j*j),a/e<1e-12){if(P=0,h/e<1e-12)return O=-n,{x:t.x,y:t.y,z:t.z}}else P=Math.atan2(Q,B);l=j/h,_=(r=a/h)*(1-i)*(d=1/Math.sqrt(1-i*(2-i)*r*r)),m=l*d,A=0;do{A++,u=i*(p=e/Math.sqrt(1-i*m*m))/(p+(O=a*_+j*m-p*(1-i*m*m))),x=(M=l*(d=1/Math.sqrt(1-u*(2-u)*r*r)))*_-(v=r*(1-u)*d)*m,_=v,m=M}while(x*x>1e-24&&A<30);return{x:P,y:Math.atan(M/Math.abs(v)),z:O}}function It(t){return t===lt||t===ct}function ri(t,i,e){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;for(var n={x:-e.x,y:e.y},a={x:Number.NaN,y:Number.NaN},h=[],l=0;l<t.grids.length;l++){var r=t.grids[l];if(h.push(r.name),r.isNull){a=n;break}if(null!==r.grid){var d=r.grid.subgrids[0],u=(Math.abs(d.del[1])+Math.abs(d.del[0]))/1e4;if(!(d.ll[1]-u>n.y||d.ll[0]-u>n.x||d.ll[1]+(d.lim[1]-1)*d.del[1]+u<n.y||d.ll[0]+(d.lim[0]-1)*d.del[0]+u<n.x||(a=$i(n,i,d),isNaN(a.x))))break}else if(r.mandatory)return console.log("Unable to find mandatory grid '"+r.name+"'"),-1}return isNaN(a.x)?(console.log("Failed to find a grid shift table for location '"+-n.x*et+" "+n.y*et+" tried: '"+h+"'"),-1):(e.x=-a.x,e.y=a.y,0)}function $i(t,i,e){var n={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return n;var a={x:t.x,y:t.y};a.x-=e.ll[0],a.y-=e.ll[1],a.x=C(a.x-Math.PI)+Math.PI;var h=hi(a,e);if(i){if(isNaN(h.x))return n;h.x=a.x-h.x,h.y=a.y-h.y;var l,r,d=9;do{if(r=hi(h,e),isNaN(r.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}h.x+=(l={x:a.x-(r.x+h.x),y:a.y-(r.y+h.y)}).x,h.y+=l.y}while(d--&&Math.abs(l.x)>1e-12&&Math.abs(l.y)>1e-12);if(d<0)return console.log("Inverse grid shift iterator failed to converge."),n;n.x=C(h.x+e.ll[0]),n.y=h.y+e.ll[1]}else isNaN(h.x)||(n.x=t.x+h.x,n.y=t.y+h.y);return n}function hi(t,i){var e,n={x:t.x/i.del[0],y:t.y/i.del[1]},a_x=Math.floor(n.x),a_y=Math.floor(n.y),h_x=n.x-1*a_x,h_y=n.y-1*a_y,l={x:Number.NaN,y:Number.NaN};if(a_x<0||a_x>=i.lim[0]||a_y<0||a_y>=i.lim[1])return l;var r_x=i.cvs[e=a_y*i.lim[0]+a_x][0],r_y=i.cvs[e][1];e++;var d_x=i.cvs[e][0],d_y=i.cvs[e][1],u_x=i.cvs[e+=i.lim[0]][0],u_y=i.cvs[e][1];e--;var p_y=i.cvs[e][1],_=h_x*h_y,m=h_x*(1-h_y),v=(1-h_x)*(1-h_y),M=(1-h_x)*h_y;return l.x=v*r_x+m*d_x+M*i.cvs[e][0]+_*u_x,l.y=v*r_y+m*d_y+M*p_y+_*u_y,l}function li(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Nt(t,i,e,n){var a;if(Array.isArray(e)&&(e=bi(e)),Ce(e),t.datum&&i.datum&&function te(t,i){return(t.datum.datum_type===lt||t.datum.datum_type===ct)&&"WGS84"!==i.datumCode||(i.datum.datum_type===lt||i.datum.datum_type===ct)&&"WGS84"!==t.datumCode}(t,i)&&(e=Nt(t,a=new it("WGS84"),e,n),t=a),n&&"enu"!==t.axis&&(e=vi(t,!1,e)),"longlat"===t.projName)e={x:e.x*V,y:e.y*V,z:e.z||0};else if(t.to_meter&&(e={x:e.x*t.to_meter,y:e.y*t.to_meter,z:e.z||0}),!(e=t.inverse(e)))return;if(t.from_greenwich&&(e.x+=t.from_greenwich),e=Te(t.datum,i.datum,e))return i.from_greenwich&&(e={x:e.x-i.from_greenwich,y:e.y,z:e.z||0}),"longlat"===i.projName?e={x:e.x*et,y:e.y*et,z:e.z||0}:(e=i.forward(e),i.to_meter&&(e={x:e.x/i.to_meter,y:e.y/i.to_meter,z:e.z||0})),n&&"enu"!==i.axis?vi(i,!0,e):e}function Xt(t,i,e,n){var a,h,l;return Array.isArray(e)?(a=Nt(t,i,e,n)||{x:NaN,y:NaN},e.length>2?void 0!==t.name&&"geocent"===t.name||void 0!==i.name&&"geocent"===i.name?"number"==typeof a.z?[a.x,a.y,a.z].concat(e.splice(3)):[a.x,a.y,e[2]].concat(e.splice(3)):[a.x,a.y].concat(e.splice(2)):[a.x,a.y]):(h=Nt(t,i,e,n),2===(l=Object.keys(e)).length||l.forEach(function(r){if(void 0!==t.name&&"geocent"===t.name||void 0!==i.name&&"geocent"===i.name){if("x"===r||"y"===r||"z"===r)return}else if("x"===r||"y"===r)return;h[r]=e[r]}),h)}function ci(t){return t instanceof it?t:t.oProj?t.oProj:it(t)}function K(t,i,e){t=ci(t);var n,a=!1;return void 0===i?(i=t,t=wi,a=!0):(void 0!==i.x||Array.isArray(i))&&(e=i,i=t,t=wi,a=!0),i=ci(i),e?Xt(t,i,e):(n={forward:function(h,l){return Xt(t,i,h,l)},inverse:function(h,l){return Xt(i,t,h,l)}},a&&(n.oProj=i),n)}function di(t,i){return i=i||5,function se(t,i){var e="00000"+t.easting,n="00000"+t.northing;return t.zoneNumber+t.zoneLetter+function ae(t,i,e){var n=_i(e);return function oe(t,i,e){var n=e-1,a=Ei.charCodeAt(n),h=ki.charCodeAt(n),l=a+t-1,r=h+i,d=!1;return l>kt&&(l=l-kt+_t-1,d=!0),(l===J||a<J&&l>J||(l>J||a<J)&&d)&&l++,(l===$||a<$&&l>$||(l>$||a<$)&&d)&&++l===J&&l++,l>kt&&(l=l-kt+_t-1),r>Et?(r=r-Et+_t-1,d=!0):d=!1,(r===J||h<J&&r>J||(r>J||h<J)&&d)&&r++,(r===$||h<$&&r>$||(r>$||h<$)&&d)&&++r===J&&r++,r>Et&&(r=r-Et+_t-1),String.fromCharCode(l)+String.fromCharCode(r)}(Math.floor(t/1e5),Math.floor(i/1e5)%20,n)}(t.easting,t.northing,t.zoneNumber)+e.substr(e.length-5,i)+n.substr(n.length-5,i)}(function ie(t){var i,e,n,a,l,r,d=t.lat,u=t.lon,p=6378137,_=Yt(d),m=Yt(u);r=Math.floor((u+180)/6)+1,180===u&&(r=60),d>=56&&d<64&&u>=3&&u<12&&(r=32),d>=72&&d<84&&(u>=0&&u<9?r=31:u>=9&&u<21?r=33:u>=21&&u<33?r=35:u>=33&&u<42&&(r=37)),l=Yt(6*(r-1)-180+3),i=p/Math.sqrt(1-.00669438*Math.sin(_)*Math.sin(_)),e=Math.tan(_)*Math.tan(_),n=.006739496752268451*Math.cos(_)*Math.cos(_);var v=.9996*i*((a=Math.cos(_)*(m-l))+(1-e+n)*a*a*a/6+(5-18*e+e*e+72*n-.39089081163157013)*a*a*a*a*a/120)+5e5,M=.9996*(p*(.9983242984503243*_-.002514607064228144*Math.sin(2*_)+2639046602129982e-21*Math.sin(4*_)-3.418046101696858e-9*Math.sin(6*_))+i*Math.tan(_)*(a*a/2+(5-e+9*n+4*n*n)*a*a*a*a/24+(61-58*e+e*e+600*n-2.2240339282485886)*a*a*a*a*a*a/720));return d<0&&(M+=1e7),{northing:Math.round(M),easting:Math.round(v),zoneNumber:r,zoneLetter:ee(d)}}({lat:t[1],lon:t[0]}),i)}function ui(t){var i=Jt(fi(t.toUpperCase()));return i.lat&&i.lon?[i.lon,i.lat]:[(i.left+i.right)/2,(i.top+i.bottom)/2]}function Yt(t){return t*(Math.PI/180)}function pi(t){return t/Math.PI*180}function Jt(t){var i=t.northing,e=t.easting,n=t.zoneLetter,a=t.zoneNumber;if(a<0||a>60)return null;var h,l,r,d,u,p,_,m,v=6378137,M=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),x=e-5e5,A=i;n<"N"&&(A-=1e7),p=6*(a-1)-180+3,m=(_=A/.9996/6367449.145945056)+(3*M/2-27*M*M*M/32)*Math.sin(2*_)+(21*M*M/16-55*M*M*M*M/32)*Math.sin(4*_)+151*M*M*M/96*Math.sin(6*_),h=v/Math.sqrt(1-.00669438*Math.sin(m)*Math.sin(m)),l=Math.tan(m)*Math.tan(m),r=.006739496752268451*Math.cos(m)*Math.cos(m),d=.99330562*v/Math.pow(1-.00669438*Math.sin(m)*Math.sin(m),1.5),u=x/(.9996*h);var P=m-h*Math.tan(m)/d*(u*u/2-(5+3*l+10*r-4*r*r-.06065547077041606)*u*u*u*u/24+(61+90*l+298*r+45*l*l-1.6983531815716497-3*r*r)*u*u*u*u*u*u/720);P=pi(P);var O,R=(u-(1+2*l+r)*u*u*u/6+(5-2*r+28*l-3*r*r+.05391597401814761+24*l*l)*u*u*u*u*u/120)/Math.cos(m);if(R=p+pi(R),t.accuracy){var B=Jt({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});O={top:B.lat,right:B.lon,bottom:P,left:R}}else O={lat:P,lon:R};return O}function ee(t){var i="Z";return 84>=t&&t>=72?i="X":72>t&&t>=64?i="W":64>t&&t>=56?i="V":56>t&&t>=48?i="U":48>t&&t>=40?i="T":40>t&&t>=32?i="S":32>t&&t>=24?i="R":24>t&&t>=16?i="Q":16>t&&t>=8?i="P":8>t&&t>=0?i="N":0>t&&t>=-8?i="M":-8>t&&t>=-16?i="L":-16>t&&t>=-24?i="K":-24>t&&t>=-32?i="J":-32>t&&t>=-40?i="H":-40>t&&t>=-48?i="G":-48>t&&t>=-56?i="F":-56>t&&t>=-64?i="E":-64>t&&t>=-72?i="D":-72>t&&t>=-80&&(i="C"),i}function _i(t){var i=t%xi;return 0===i&&(i=xi),i}function fi(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var i,e=t.length,n=null,a="",h=0;!/[A-Z]/.test(i=t.charAt(h));){if(h>=2)throw"MGRSPoint bad conversion from: "+t;a+=i,h++}var l=parseInt(a,10);if(0===h||h+3>e)throw"MGRSPoint bad conversion from: "+t;var r=t.charAt(h++);if(r<="A"||"B"===r||"Y"===r||r>="Z"||"I"===r||"O"===r)throw"MGRSPoint zone letter "+r+" not handled: "+t;n=t.substring(h,h+=2);for(var d=_i(l),u=function ne(t,i){for(var e=Ei.charCodeAt(i-1),n=1e5,a=!1;e!==t.charCodeAt(0);){if(++e===J&&e++,e===$&&e++,e>kt){if(a)throw"Bad character: "+t;e=_t,a=!0}n+=1e5}return n}(n.charAt(0),d),p=function re(t,i){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var e=ki.charCodeAt(i-1),n=0,a=!1;e!==t.charCodeAt(0);){if(++e===J&&e++,e===$&&e++,e>Et){if(a)throw"Bad character: "+t;e=_t,a=!0}n+=1e5}return n}(n.charAt(1),d);p<he(r);)p+=2e6;var _=e-h;if(_%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var m,v,M,P=_/2,R=0,O=0;return P>0&&(m=1e5/Math.pow(10,P),v=t.substring(h,h+P),R=parseFloat(v)*m,M=t.substring(h+P),O=parseFloat(M)*m),{easting:R+u,northing:O+p,zoneLetter:r,zoneNumber:l,accuracy:m}}function he(t){var i;switch(t){case"C":i=11e5;break;case"D":i=2e6;break;case"E":i=28e5;break;case"F":i=37e5;break;case"G":i=46e5;break;case"H":i=55e5;break;case"J":i=64e5;break;case"K":i=73e5;break;case"L":i=82e5;break;case"M":i=91e5;break;case"N":i=0;break;case"P":i=8e5;break;case"Q":i=17e5;break;case"R":i=26e5;break;case"S":i=35e5;break;case"T":i=44e5;break;case"U":i=53e5;break;case"V":i=62e5;break;case"W":i=7e6;break;case"X":i=79e5;break;default:i=-1}if(i>=0)return i;throw"Invalid zone letter: "+t}function ut(t,i,e){if(!(this instanceof ut))return new ut(t,i,e);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===i){var n=t.split(",");this.x=parseFloat(n[0],10),this.y=parseFloat(n[1],10),this.z=parseFloat(n[2],10)||0}else this.x=t,this.y=i,this.z=e||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function Rt(t,i,e,n){var a;return t<k?(n.value=z.AREA_0,a=0):(a=Math.atan2(i,e),Math.abs(a)<=G?n.value=z.AREA_0:a>G&&a<=y+G?(n.value=z.AREA_1,a-=y):a>y+G||a<=-(y+G)?(n.value=z.AREA_2,a=a>=0?a-q:a+q):(n.value=z.AREA_3,a+=y)),a}function pt(t,i){var e=t+i;return e<-q?e+=vt:e>+q&&(e-=vt),e}var lt=1,ct=2,Gt=3,pe=4,Zt=5,yt=484813681109536e-20,y=Math.PI/2,_e=.16666666666666666,fe=.04722222222222222,me=.022156084656084655,k=1e-10,V=.017453292519943295,et=57.29577951308232,G=Math.PI/4,vt=2*Math.PI,q=3.14159265359,Y={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},Me={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},mi=/[\s_\-\/\(\)]/g,Kt=function(t){var i,e,n,a={},h=t.split("+").map(function(r){return r.trim()}).filter(function(r){return r}).reduce(function(r,d){var u=d.split("=");return u.push(!0),r[u[0].toLowerCase()]=u[1],r},{}),l={proj:"projName",datum:"datumCode",rf:function(r){a.rf=parseFloat(r)},lat_0:function(r){a.lat0=r*V},lat_1:function(r){a.lat1=r*V},lat_2:function(r){a.lat2=r*V},lat_ts:function(r){a.lat_ts=r*V},lon_0:function(r){a.long0=r*V},lon_1:function(r){a.long1=r*V},lon_2:function(r){a.long2=r*V},alpha:function(r){a.alpha=parseFloat(r)*V},gamma:function(r){a.rectified_grid_angle=parseFloat(r)},lonc:function(r){a.longc=r*V},x_0:function(r){a.x0=parseFloat(r)},y_0:function(r){a.y0=parseFloat(r)},k_0:function(r){a.k0=parseFloat(r)},k:function(r){a.k0=parseFloat(r)},a:function(r){a.a=parseFloat(r)},b:function(r){a.b=parseFloat(r)},r_a:function(){a.R_A=!0},zone:function(r){a.zone=parseInt(r,10)},south:function(){a.utmSouth=!0},towgs84:function(r){a.datum_params=r.split(",").map(function(d){return parseFloat(d)})},to_meter:function(r){a.to_meter=parseFloat(r)},units:function(r){a.units=r;var d=D(Me,r);d&&(a.to_meter=d.to_meter)},from_greenwich:function(r){a.from_greenwich=r*V},pm:function(r){var d=D(Y,r);a.from_greenwich=(d||parseFloat(r))*V},nadgrids:function(r){"@null"===r?a.datumCode="none":a.nadgrids=r},axis:function(r){3===r.length&&-1!=="ewnsud".indexOf(r.substr(0,1))&&-1!=="ewnsud".indexOf(r.substr(1,1))&&-1!=="ewnsud".indexOf(r.substr(2,1))&&(a.axis=r)},approx:function(){a.approx=!0}};for(i in h)e=h[i],i in l?"function"==typeof(n=l[i])?n(e):a[n]=e:a[i]=e;return"string"==typeof a.datumCode&&"WGS84"!==a.datumCode&&(a.datumCode=a.datumCode.toLowerCase()),a},bt=1,ge=/\s/,Le=/[A-Za-z]/,ye=/[A-Za-z84]/,zt=/[,\]]/,Mi=/[\d\.E\-\+]/;N.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;ge.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case bt:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},N.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(zt.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},N.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=bt)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=bt,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},N.prototype.number=function(t){if(!Mi.test(t)){if(zt.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},N.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},N.prototype.keyword=function(t){if(ye.test(t))this.word+=t;else{if("["===t){var i=[];return i.push(this.word),this.level++,null===this.root?this.root=i:this.currentObject.push(i),this.stack.push(this.currentObject),this.currentObject=i,void(this.state=bt)}if(!zt.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},N.prototype.neutral=function(t){if(Le.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(Mi.test(t))return this.word=t,void(this.state=3);if(!zt.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},N.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var t,ve=.017453292519943295,gi=function(t){var i=function E(t){return new N(t).output()}(t),e=i.shift(),n=i.shift();i.unshift(["name",n]),i.unshift(["type",e]);var a={};return s(i,a),function f(t){function i(r){return r*(t.to_meter||1)}if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):t.projName="object"==typeof t.PROJECTION?Object.keys(t.PROJECTION)[0]:t.PROJECTION,t.AXIS){for(var e="",n=0,a=t.AXIS.length;n<a;++n){var h=[t.AXIS[n][0].toLowerCase(),t.AXIS[n][1].toLowerCase()];-1!==h[0].indexOf("north")||("y"===h[0]||"lat"===h[0])&&"north"===h[1]?e+="n":-1!==h[0].indexOf("south")||("y"===h[0]||"lat"===h[0])&&"south"===h[1]?e+="s":-1!==h[0].indexOf("east")||("x"===h[0]||"lon"===h[0])&&"east"===h[1]?e+="e":-1===h[0].indexOf("west")&&("x"!==h[0]&&"lon"!==h[0]||"west"!==h[1])||(e+="w")}2===e.length&&(e+="u"),3===e.length&&(t.axis=e)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var l=t.GEOGCS;"GEOGCS"===t.type&&(l=t),l&&(t.datumCode=l.DATUM?l.DATUM.name.toLowerCase():l.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),l.DATUM&&l.DATUM.SPHEROID&&(t.ellps=l.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=l.DATUM.SPHEROID.a,t.rf=parseFloat(l.DATUM.SPHEROID.rf,10)),l.DATUM&&l.DATUM.TOWGS84&&(t.datum_params=l.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",c],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",c],["x0","false_easting",i],["y0","false_northing",i],["long0","central_meridian",c],["lat0","latitude_of_origin",c],["lat0","standard_parallel_1",c],["lat1","standard_parallel_1",c],["lat2","standard_parallel_2",c],["azimuth","Azimuth"],["alpha","azimuth",c],["srsCode","name"]].forEach(function(r){return function o(t,i){var e=i[0],n=i[1];!(e in t)&&n in t&&(t[e]=t[n],3===i.length&&(t[e]=i[2](t[e])))}(t,r)}),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=c(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(a),a};(t=g)("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"];var be=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],we=["3857","900913","3785","102113"],Li=function(t,i){var e,n;if(t=t||{},!i)return t;for(n in i)void 0!==(e=i[n])&&(t[n]=e);return t},st=function(t,i,e){var n=t*i;return e/Math.sqrt(1-n*n)},wt=function(t){return t<0?-1:1},C=function(t){return Math.abs(t)<=q?t:t-wt(t)*vt},tt=function(t,i,e){var n=t*e;return n=Math.pow((1-n)/(1+n),.5*t),Math.tan(.5*(y-i))/n},xt=function(t,i){for(var e,n,a=.5*t,h=y-2*Math.atan(i),l=0;l<=15;l++)if(e=t*Math.sin(h),h+=n=y-2*Math.atan(i*Math.pow((1-e)/(1+e),a))-h,Math.abs(n)<=1e-10)return h;return-9999},xe=[{init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):st(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function(t){var n,a,i=t.x,e=t.y;if(e*et>90&&e*et<-90&&i*et>180&&i*et<-180)return null;if(Math.abs(Math.abs(e)-y)<=k)return null;if(this.sphere)n=this.x0+this.a*this.k0*C(i-this.long0),a=this.y0+this.a*this.k0*Math.log(Math.tan(G+.5*e));else{var h=Math.sin(e),l=tt(this.e,e,h);n=this.x0+this.a*this.k0*C(i-this.long0),a=this.y0-this.a*this.k0*Math.log(l)}return t.x=n,t.y=a,t},inverse:function(t){var i,e,n=t.x-this.x0,a=t.y-this.y0;if(this.sphere)e=y-2*Math.atan(Math.exp(-a/(this.a*this.k0)));else{var h=Math.exp(-a/(this.a*this.k0));if(-9999===(e=xt(this.e,h)))return null}return i=C(this.long0+n/(this.a*this.k0)),t.x=i,t.y=e,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:si,inverse:si,names:["longlat","identity"]}],Ut={},qt=[],Ee={start:function(){xe.forEach(ai)},add:ai,get:function(t){if(!t)return!1;var i=t.toLowerCase();return void 0!==Ut[i]&&qt[Ut[i]]?qt[Ut[i]]:void 0}},S={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ke=S.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};S.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var F={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},yi={};(it.projections=Ee).start();var Te=function(t,i,e){if(function Ji(t,i){return t.datum_type===i.datum_type&&!(t.a!==i.a||Math.abs(t.es-i.es)>5e-11)&&(t.datum_type===lt?t.datum_params[0]===i.datum_params[0]&&t.datum_params[1]===i.datum_params[1]&&t.datum_params[2]===i.datum_params[2]:t.datum_type!==ct||t.datum_params[0]===i.datum_params[0]&&t.datum_params[1]===i.datum_params[1]&&t.datum_params[2]===i.datum_params[2]&&t.datum_params[3]===i.datum_params[3]&&t.datum_params[4]===i.datum_params[4]&&t.datum_params[5]===i.datum_params[5]&&t.datum_params[6]===i.datum_params[6])}(t,i)||t.datum_type===Zt||i.datum_type===Zt)return e;var n=t.a,a=t.es;if(t.datum_type===Gt){if(0!==ri(t,!1,e))return;n=6378137,a=.0066943799901413165}var h=i.a,l=i.b,r=i.es;return i.datum_type===Gt&&(h=6378137,l=6356752.314,r=.0066943799901413165),a!==r||n!==h||It(t.datum_type)||It(i.datum_type)?(e=oi(e,a,n),It(t.datum_type)&&(e=function Zi(t,i,e){if(i===lt)return{x:t.x+e[0],y:t.y+e[1],z:t.z+e[2]};if(i===ct){var l=e[3],r=e[4],d=e[5],u=e[6];return{x:u*(t.x-d*t.y+r*t.z)+e[0],y:u*(d*t.x+t.y-l*t.z)+e[1],z:u*(-r*t.x+l*t.y+t.z)+e[2]}}}(e,t.datum_type,t.datum_params)),It(i.datum_type)&&(e=function Ki(t,i,e){if(i===lt)return{x:t.x-e[0],y:t.y-e[1],z:t.z-e[2]};if(i===ct){var l=e[3],r=e[4],d=e[5],u=e[6],p=(t.x-e[0])/u,_=(t.y-e[1])/u,m=(t.z-e[2])/u;return{x:p+d*_-r*m,y:-d*p+_+l*m,z:r*p-l*_+m}}}(e,i.datum_type,i.datum_params)),e=ni(e,r,h,l),i.datum_type!==Gt||0===ri(i,!0,e)?e:void 0):e},vi=function(t,i,e){var n,a,h,l=e.x,r=e.y,d=e.z||0,u={};for(h=0;h<3;h++)if(!i||2!==h||void 0!==e.z)switch(0===h?(n=l,a=-1!=="ew".indexOf(t.axis[h])?"x":"y"):1===h?(n=r,a=-1!=="ns".indexOf(t.axis[h])?"y":"x"):(n=d,a="z"),t.axis[h]){case"e":case"n":u[a]=n;break;case"w":case"s":u[a]=-n;break;case"u":void 0!==e[a]&&(u.z=n);break;case"d":void 0!==e[a]&&(u.z=-n);break;default:return null}return u},bi=function(t){var i={x:t[0],y:t[1]};return t.length>2&&(i.z=t[2]),t.length>3&&(i.m=t[3]),i},Ce=function(t){li(t.x),li(t.y)},wi=it("WGS84"),xi=6,Ei="AJSAJS",ki="AFAFAF",_t=65,J=73,$=79,Et=86,kt=90,De={forward:di,inverse:function(t){var i=Jt(fi(t.toUpperCase()));return i.lat&&i.lon?[i.lon,i.lat,i.lon,i.lat]:[i.left,i.bottom,i.right,i.top]},toPoint:ui};ut.fromMGRS=function(t){return new ut(ui(t))},ut.prototype.toMGRS=function(t){return di([this.x,this.y],t)};var Ti=.01068115234375,Ci=function(t){var i=[];i[0]=1-t*(.25+t*(.046875+t*(.01953125+t*Ti))),i[1]=t*(.75-t*(.046875+t*(.01953125+t*Ti)));var e=t*t;return i[2]=e*(.46875-t*(.013020833333333334+.007120768229166667*t)),i[3]=(e*=t)*(.3645833333333333-.005696614583333333*t),i[4]=e*t*.3076171875,i},Bt=function(t,i,e,n){return n[0]*t-(e*=i)*(n[1]+(i*=i)*(n[2]+i*(n[3]+i*n[4])))},Di=function(t,i,e){for(var n=1/(1-i),a=t,h=20;h;--h){var l=Math.sin(a),r=1-i*l*l;if(a-=r=(Bt(a,l,Math.cos(a),e)-t)*(r*Math.sqrt(r))*n,Math.abs(r)<k)return a}return a},Ht={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Ci(this.es),this.ml0=Bt(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var i,e,n,h=t.y,l=C(t.x-this.long0),r=Math.sin(h),d=Math.cos(h);if(this.es){var u=d*l,p=Math.pow(u,2),_=this.ep2*Math.pow(d,2),m=Math.pow(_,2),v=Math.abs(d)>k?Math.tan(h):0,M=Math.pow(v,2),x=Math.pow(M,2);i=1-this.es*Math.pow(r,2),u/=Math.sqrt(i);var A=Bt(h,r,d,this.en);e=this.a*(this.k0*u*(1+p/6*(1-M+_+p/20*(5-18*M+x+14*_-58*M*_+p/42*(61+179*x-x*M-479*M)))))+this.x0,n=this.a*(this.k0*(A-this.ml0+r*l*u/2*(1+p/12*(5-M+9*_+4*m+p/30*(61+x-58*M+270*_-330*M*_+p/56*(1385+543*x-x*M-3111*M))))))+this.y0}else{var P=d*Math.sin(l);if(Math.abs(Math.abs(P)-1)<k)return 93;if(e=.5*this.a*this.k0*Math.log((1+P)/(1-P))+this.x0,n=d*Math.cos(l)/Math.sqrt(1-Math.pow(P,2)),(P=Math.abs(n))>=1){if(P-1>k)return 93;n=0}else n=Math.acos(n);h<0&&(n=-n),n=this.a*this.k0*(n-this.lat0)+this.y0}return t.x=e,t.y=n,t},inverse:function(t){var i,e,n,a,h=1/this.a*(t.x-this.x0),l=1/this.a*(t.y-this.y0);if(this.es)if(e=Di(i=this.ml0+l/this.k0,this.es,this.en),Math.abs(e)<y){var r=Math.sin(e),d=Math.cos(e),u=Math.abs(d)>k?Math.tan(e):0,p=this.ep2*Math.pow(d,2),_=Math.pow(p,2),m=Math.pow(u,2),v=Math.pow(m,2);i=1-this.es*Math.pow(r,2);var M=h*Math.sqrt(i)/this.k0,x=Math.pow(M,2);n=e-(i*=u)*x/(1-this.es)*.5*(1-x/12*(5+3*m-9*p*m+p-4*_-x/30*(61+90*m-252*p*m+45*v+46*p-x/56*(1385+3633*m+4095*v+1574*v*m)))),a=C(this.long0+M*(1-x/6*(1+2*m+p-x/20*(5+28*m+24*v+8*p*m+6*p-x/42*(61+662*m+1320*v+720*v*m))))/d)}else n=y*wt(l),a=0;else{var A=Math.exp(h/this.k0),P=.5*(A-1/A),O=Math.cos(this.lat0+l/this.k0);i=Math.sqrt((1-Math.pow(O,2))/(1+Math.pow(P,2))),n=Math.asin(i),l<0&&(n=-n),a=0===P&&0===O?0:C(Math.atan2(P,O)+this.long0)}return t.x=a,t.y=n,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]},Pi=function(t){var i=Math.exp(t);return(i-1/i)/2},jt=function(t,i){t=Math.abs(t),i=Math.abs(i);var e=Math.max(t,i),n=Math.min(t,i)/(e||1);return e*Math.sqrt(1+Math.pow(n,2))},$t=function(t,i){for(var e,n=2*Math.cos(2*i),a=t.length-1,h=t[a],l=0;--a>=0;)e=n*h-l+t[a],l=h,h=e;return i+e*Math.sin(2*i)},Si=function(t,i,e){for(var n,a,h=Math.sin(i),l=Math.cos(i),r=Pi(e),d=function(t){var i=Math.exp(t);return(i+1/i)/2}(e),u=2*l*d,p=-2*h*r,_=t.length-1,m=t[_],v=0,M=0,x=0;--_>=0;)n=M,a=v,m=u*(M=m)-n-p*(v=x)+t[_],x=p*M-a+u*v;return[(u=h*d)*m-(p=l*r)*x,u*x+p*m]},Ft={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Ht.init.apply(this),this.forward=Ht.forward,this.inverse=Ht.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),i=t/(2-t),e=i;this.cgb[0]=i*(2+i*(-2/3+i*(i*(116/45+i*(26/45+i*(-2854/675)))-2))),this.cbg[0]=i*(i*(2/3+i*(4/3+i*(-82/45+i*(32/45+i*(4642/4725)))))-2),this.cgb[1]=(e*=i)*(7/3+i*(i*(-227/45+i*(2704/315+i*(2323/945)))-1.6)),this.cbg[1]=e*(5/3+i*(-16/15+i*(-13/9+i*(904/315+i*(-1522/945))))),this.cgb[2]=(e*=i)*(56/15+i*(-136/35+i*(-1262/105+i*(73814/2835)))),this.cbg[2]=e*(-26/15+i*(34/21+i*(1.6+i*(-12686/2835)))),this.cgb[3]=(e*=i)*(4279/630+i*(-332/35+i*(-399572/14175))),this.cbg[3]=e*(1237/630+i*(i*(-24832/14175)-2.4)),this.cgb[4]=(e*=i)*(4174/315+i*(-144838/6237)),this.cbg[4]=e*(-734/315+i*(109598/31185)),this.cgb[5]=(e*=i)*(601676/22275),this.cbg[5]=e*(444337/155925),e=Math.pow(i,2),this.Qn=this.k0/(1+i)*(1+e*(.25+e*(1/64+e/256))),this.utg[0]=i*(i*(2/3+i*(-37/96+i*(1/360+i*(81/512+i*(-96199/604800)))))-.5),this.gtu[0]=i*(.5+i*(-2/3+i*(5/16+i*(41/180+i*(-127/288+i*(7891/37800)))))),this.utg[1]=e*(-1/48+i*(-1/15+i*(437/1440+i*(-46/105+i*(1118711/3870720))))),this.gtu[1]=e*(13/48+i*(i*(557/1440+i*(281/630+i*(-1983433/1935360)))-.6)),this.utg[2]=(e*=i)*(-17/480+i*(37/840+i*(209/4480+i*(-5569/90720)))),this.gtu[2]=e*(61/240+i*(-103/140+i*(15061/26880+i*(167603/181440)))),this.utg[3]=(e*=i)*(-4397/161280+i*(11/504+i*(830251/7257600))),this.gtu[3]=e*(49561/161280+i*(-179/168+i*(6601661/7257600))),this.utg[4]=(e*=i)*(-4583/161280+i*(108847/3991680)),this.gtu[4]=e*(34729/80640+i*(-3418889/1995840)),this.utg[5]=-.03233083094085698*(e*=i),this.gtu[5]=.6650675310896665*e;var n=$t(this.cbg,this.lat0);this.Zb=-this.Qn*(n+function(t,i){for(var e,n=2*Math.cos(i),a=t.length-1,h=t[a],l=0;--a>=0;)e=n*h-l+t[a],l=h,h=e;return Math.sin(i)*e}(this.gtu,2*n))},forward:function(t){var i=C(t.x-this.long0),e=t.y;e=$t(this.cbg,e);var n=Math.sin(e),a=Math.cos(e),h=Math.sin(i),l=Math.cos(i);e=Math.atan2(n,l*a),i=Math.atan2(h*a,jt(n,a*l)),i=function(t){var i=Math.abs(t);return i=function(t){var i=1+t,e=i-1;return 0===e?t:t*Math.log(i)/e}(i*(1+i/(jt(1,i)+1))),t<0?-i:i}(Math.tan(i));var d,u,r=Si(this.gtu,2*e,2*i);return e+=r[0],i+=r[1],Math.abs(i)<=2.623395162778?(d=this.a*(this.Qn*i)+this.x0,u=this.a*(this.Qn*e+this.Zb)+this.y0):(d=1/0,u=1/0),t.x=d,t.y=u,t},inverse:function(t){var n,a,i=1/this.a*(t.x-this.x0),e=1/this.a*(t.y-this.y0);if(e=(e-this.Zb)/this.Qn,i/=this.Qn,Math.abs(i)<=2.623395162778){var h=Si(this.utg,2*e,2*i);e+=h[0],i+=h[1],i=Math.atan(Pi(i));var l=Math.sin(e),r=Math.cos(e),d=Math.sin(i),u=Math.cos(i);e=Math.atan2(l*u,jt(d,u*r)),i=Math.atan2(d,u*r),n=C(i+this.long0),a=$t(this.cgb,e)}else n=1/0,a=1/0;return t.x=n,t.y=a,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},Ne={init:function(){var t=function(t,i){if(void 0===t){if((t=Math.floor(30*(C(i)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*V,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Ft.init.apply(this),this.forward=Ft.forward,this.inverse=Ft.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},ti=function(t,i){return Math.pow((1-t)/(1+t),i)},ii={init:function(){var t=Math.sin(this.lat0),i=Math.cos(this.lat0);i*=i,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*i*i/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+G)/(Math.pow(Math.tan(.5*this.lat0+G),this.C)*ti(this.e*t,this.ratexp))},forward:function(t){var i=t.x,e=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+G),this.C)*ti(this.e*Math.sin(e),this.ratexp))-y,t.x=this.C*i,t},inverse:function(t){for(var i=t.x/this.C,e=t.y,n=Math.pow(Math.tan(.5*e+G)/this.K,1/this.C),a=20;a>0&&(e=2*Math.atan(n*ti(this.e*Math.sin(t.y),-.5*this.e))-y,!(Math.abs(e-t.y)<1e-14));--a)t.y=e;return a?(t.x=i,t.y=e,t):null},names:["gauss"]},Ge={init:function(){ii.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var i,e,n,a;return t.x=C(t.x-this.long0),ii.forward.apply(this,[t]),i=Math.sin(t.y),e=Math.cos(t.y),n=Math.cos(t.x),t.x=(a=this.k0*this.R2/(1+this.sinc0*i+this.cosc0*e*n))*e*Math.sin(t.x),t.y=a*(this.cosc0*i-this.sinc0*e*n),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var i,e,n,a,h;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,h=Math.sqrt(t.x*t.x+t.y*t.y)){var l=2*Math.atan2(h,this.R2);i=Math.sin(l),e=Math.cos(l),a=Math.asin(e*this.sinc0+t.y*i*this.cosc0/h),n=Math.atan2(t.x*i,h*this.cosc0*e-t.y*this.sinc0*i)}else a=this.phic0,n=0;return t.x=n,t.y=a,ii.inverse.apply(this,[t]),t.x=C(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},ze={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=k&&(this.k0=.5*(1+wt(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=k&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=k&&(this.k0=.5*this.cons*st(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/tt(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=st(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-y,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var i,e,n,a,h,l,r=t.x,d=t.y,u=Math.sin(d),p=Math.cos(d),_=C(r-this.long0);return Math.abs(Math.abs(r-this.long0)-Math.PI)<=k&&Math.abs(d+this.lat0)<=k?(t.x=NaN,t.y=NaN,t):this.sphere?(i=2*this.k0/(1+this.sinlat0*u+this.coslat0*p*Math.cos(_)),t.x=this.a*i*p*Math.sin(_)+this.x0,t.y=this.a*i*(this.coslat0*u-this.sinlat0*p*Math.cos(_))+this.y0,t):(e=2*Math.atan(this.ssfn_(d,u,this.e))-y,a=Math.cos(e),n=Math.sin(e),Math.abs(this.coslat0)<=k?(h=tt(this.e,d*this.con,this.con*u),t.x=this.x0+(l=2*this.a*this.k0*h/this.cons)*Math.sin(r-this.long0),t.y=this.y0-this.con*l*Math.cos(r-this.long0),t):(Math.abs(this.sinlat0)<k?(i=2*this.a*this.k0/(1+a*Math.cos(_)),t.y=i*n):(i=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*a*Math.cos(_))),t.y=i*(this.cosX0*n-this.sinX0*a*Math.cos(_))+this.y0),t.x=i*a*Math.sin(_)+this.x0,t))},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var i,e,a,h,l=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var r=2*Math.atan(l/(2*this.a*this.k0));return i=this.long0,e=this.lat0,l<=k?(t.x=i,t.y=e,t):(e=Math.asin(Math.cos(r)*this.sinlat0+t.y*Math.sin(r)*this.coslat0/l),i=C(Math.abs(this.coslat0)<k?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(r),l*this.coslat0*Math.cos(r)-t.y*this.sinlat0*Math.sin(r))),t.x=i,t.y=e,t)}if(Math.abs(this.coslat0)<=k){if(l<=k)return e=this.lat0,t.x=i=this.long0,t.y=e,t;t.x*=this.con,t.y*=this.con,e=this.con*xt(this.e,l*this.cons/(2*this.a*this.k0)),i=this.con*C(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else a=2*Math.atan(l*this.cosX0/(2*this.a*this.k0*this.ms1)),i=this.long0,l<=k?h=this.X0:(h=Math.asin(Math.cos(a)*this.sinX0+t.y*Math.sin(a)*this.cosX0/l),i=C(this.long0+Math.atan2(t.x*Math.sin(a),l*this.cosX0*Math.cos(a)-t.y*this.sinX0*Math.sin(a)))),e=-1*xt(this.e,Math.tan(.5*(y+h)));return t.x=i,t.y=e,t},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(t,i,e){return i*=e,Math.tan(.5*(y+t))*Math.pow((1-i)/(1+i),.5*e)}},Ue={init:function(){var t=this.lat0;this.lambda0=this.long0;var i=Math.sin(t),e=this.a,n=1/this.rf,a=2*n-Math.pow(n,2),h=this.e=Math.sqrt(a);this.R=this.k0*e*Math.sqrt(1-a)/(1-a*Math.pow(i,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(i/this.alpha);var l=Math.log(Math.tan(Math.PI/4+this.b0/2)),r=Math.log(Math.tan(Math.PI/4+t/2)),d=Math.log((1+h*i)/(1-h*i));this.K=l-this.alpha*r+this.alpha*h/2*d},forward:function(t){var i=Math.log(Math.tan(Math.PI/4-t.y/2)),e=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),a=2*(Math.atan(Math.exp(-this.alpha*(i+e)+this.K))-Math.PI/4),h=this.alpha*(t.x-this.lambda0),l=Math.atan(Math.sin(h)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(h))),r=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(h));return t.y=this.R/2*Math.log((1+Math.sin(r))/(1-Math.sin(r)))+this.y0,t.x=this.R*l+this.x0,t},inverse:function(t){for(var n=(t.x-this.x0)/this.R,a=2*(Math.atan(Math.exp((t.y-this.y0)/this.R))-Math.PI/4),h=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(n)),l=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(a))),r=this.lambda0+l/this.alpha,d=0,u=h,p=-1e3,_=0;Math.abs(u-p)>1e-7;){if(++_>20)return;d=1/this.alpha*(Math.log(Math.tan(Math.PI/4+h/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),p=u,u=2*Math.atan(Math.exp(d))-Math.PI/2}return t.x=r,t.y=u,t},names:["somerc"]},ft=1e-7,qe={init:function(){var t,i,e,n,a,h,l,r,d,u,p,_=0,m=0,v=0,M=0,x=0,A=0,P=0;this.no_off=function le(t){var e="object"==typeof t.PROJECTION?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(e)}(this),this.no_rot="no_rot"in this;var R=!1;"alpha"in this&&(R=!0);var O=!1;if("rectified_grid_angle"in this&&(O=!0),R&&(P=this.alpha),O&&(_=this.rectified_grid_angle*V),R||O)m=this.longc;else if(v=this.long1,x=this.lat1,M=this.long2,A=this.lat2,Math.abs(x-A)<=ft||(t=Math.abs(x))<=ft||Math.abs(t-y)<=ft||Math.abs(Math.abs(this.lat0)-y)<=ft||Math.abs(Math.abs(A)-y)<=ft)throw new Error;var B=1-this.es;i=Math.sqrt(B),Math.abs(this.lat0)>k?(r=Math.sin(this.lat0),e=Math.cos(this.lat0),t=1-this.es*r*r,this.B=e*e,this.B=Math.sqrt(1+this.es*this.B*this.B/B),this.A=this.B*this.k0*i/t,(a=(n=this.B*i/(e*Math.sqrt(t)))*n-1)<=0?a=0:(a=Math.sqrt(a),this.lat0<0&&(a=-a)),this.E=a+=n,this.E*=Math.pow(tt(this.e,this.lat0,r),this.B)):(this.B=1/i,this.A=this.k0,this.E=n=a=1),R||O?(R?(p=Math.asin(Math.sin(P)/n),O||(_=P)):(p=_,P=Math.asin(n*Math.sin(p))),this.lam0=m-Math.asin(.5*(a-1/a)*Math.tan(p))/this.B):(h=Math.pow(tt(this.e,x,Math.sin(x)),this.B),l=Math.pow(tt(this.e,A,Math.sin(A)),this.B),a=this.E/h,d=(l-h)/(l+h),u=((u=this.E*this.E)-l*h)/(u+l*h),(t=v-M)<-Math.pi?M-=vt:t>Math.pi&&(M+=vt),this.lam0=C(.5*(v+M)-Math.atan(u*Math.tan(.5*this.B*(v-M))/d)/this.B),p=Math.atan(2*Math.sin(this.B*C(v-this.lam0))/(a-1/a)),_=P=Math.asin(n*Math.sin(p))),this.singam=Math.sin(p),this.cosgam=Math.cos(p),this.sinrot=Math.sin(_),this.cosrot=Math.cos(_),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(n*n-1)/Math.cos(P))),this.lat0<0&&(this.u_0=-this.u_0)),a=.5*p,this.v_pole_n=this.ArB*Math.log(Math.tan(G-a)),this.v_pole_s=this.ArB*Math.log(Math.tan(G+a))},forward:function(t){var i,e,n,a,h,l,r,d,u={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-y)>k){if(i=.5*((h=this.E/Math.pow(tt(this.e,t.y,Math.sin(t.y)),this.B))-(l=1/h)),e=.5*(h+l),a=Math.sin(this.B*t.x),n=(i*this.singam-a*this.cosgam)/e,Math.abs(Math.abs(n)-1)<k)throw new Error;d=.5*this.ArB*Math.log((1-n)/(1+n)),l=Math.cos(this.B*t.x),r=Math.abs(l)<ft?this.A*t.x:this.ArB*Math.atan2(i*this.cosgam+a*this.singam,l)}else d=t.y>0?this.v_pole_n:this.v_pole_s,r=this.ArB*t.y;return this.no_rot?(u.x=r,u.y=d):(u.x=d*this.cosrot+(r-=this.u_0)*this.sinrot,u.y=r*this.cosrot-d*this.sinrot),u.x=this.a*u.x+this.x0,u.y=this.a*u.y+this.y0,u},inverse:function(t){var i,e,n,a,h,l,r,d={};if(t.x=1/this.a*(t.x-this.x0),t.y=1/this.a*(t.y-this.y0),this.no_rot?(e=t.y,i=t.x):(e=t.x*this.cosrot-t.y*this.sinrot,i=t.y*this.cosrot+t.x*this.sinrot+this.u_0),a=.5*((n=Math.exp(-this.BrA*e))-1/n),h=.5*(n+1/n),r=((l=Math.sin(this.BrA*i))*this.cosgam+a*this.singam)/h,Math.abs(Math.abs(r)-1)<k)d.x=0,d.y=r<0?-y:y;else{if(d.y=this.E/Math.sqrt((1+r)/(1-r)),d.y=xt(this.e,Math.pow(d.y,1/this.B)),d.y===1/0)throw new Error;d.x=-this.rB*Math.atan2(a*this.cosgam-l*this.singam,Math.cos(this.BrA*i))}return d.x+=this.lam0,d},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},Be={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<k)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var i=Math.sin(this.lat1),e=Math.cos(this.lat1),n=st(this.e,i,e),a=tt(this.e,this.lat1,i),h=Math.sin(this.lat2),l=Math.cos(this.lat2),r=st(this.e,h,l),d=tt(this.e,this.lat2,h),u=tt(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>k?Math.log(n/r)/Math.log(a/d):i,isNaN(this.ns)&&(this.ns=i),this.f0=n/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var i=t.x,e=t.y;Math.abs(2*Math.abs(e)-Math.PI)<=k&&(e=wt(e)*(y-2*k));var n,a,h=Math.abs(Math.abs(e)-y);if(h>k)n=tt(this.e,e,Math.sin(e)),a=this.a*this.f0*Math.pow(n,this.ns);else{if((h=e*this.ns)<=0)return null;a=0}var l=this.ns*C(i-this.long0);return t.x=this.k0*(a*Math.sin(l))+this.x0,t.y=this.k0*(this.rh-a*Math.cos(l))+this.y0,t},inverse:function(t){var i,e,n,a,h,l=(t.x-this.x0)/this.k0,r=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(i=Math.sqrt(l*l+r*r),e=1):(i=-Math.sqrt(l*l+r*r),e=-1);var d=0;if(0!==i&&(d=Math.atan2(e*l,e*r)),0!==i||this.ns>0){if(e=1/this.ns,n=Math.pow(i/(this.a*this.f0),e),-9999===(a=xt(this.e,n)))return null}else a=-y;return h=C(d/this.ns+this.long0),t.x=h,t.y=a,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"]},He={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var i,e,n,a,h,l,r,u=t.y,p=C(t.x-this.long0);return i=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),e=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/i)-this.s45),n=-p*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(e)+Math.sin(this.ad)*Math.cos(e)*Math.cos(n)),h=Math.asin(Math.cos(e)*Math.sin(n)/Math.cos(a)),l=this.n*h,r=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),t.y=r*Math.cos(l)/1,t.x=r*Math.sin(l)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var i,e,n,a,h,l,r,d=t.x;t.x=t.y,t.y=d,this.czech||(t.y*=-1,t.x*=-1),h=Math.sqrt(t.x*t.x+t.y*t.y),a=Math.atan2(t.y,t.x)/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/h,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),i=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(a)),e=Math.asin(Math.cos(n)*Math.sin(a)/Math.cos(i)),t.x=this.long0-e/this.alfa,l=i,r=0;var u=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(i/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.e/2))-this.s45),Math.abs(l-t.y)<1e-10&&(r=1),l=t.y,u+=1}while(0===r&&u<15);return u>=15?null:t},names:["Krovak","krovak"]},X=function(t,i,e,n,a){return t*a-i*Math.sin(2*a)+e*Math.sin(4*a)-n*Math.sin(6*a)},Tt=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))},Ct=function(t){return.375*t*(1+.25*t*(1+.46875*t))},Dt=function(t){return.05859375*t*t*(1+.75*t)},Pt=function(t){return t*t*t*(35/3072)},mt=function(t,i,e){var n=i*e;return t/Math.sqrt(1-n*n)},Mt=function(t){return Math.abs(t)<y?t:t-wt(t)*Math.PI},Vt=function(t,i,e,n,a){var h,l;h=t/i;for(var r=0;r<15;r++)if(h+=l=(t-(i*h-e*Math.sin(2*h)+n*Math.sin(4*h)-a*Math.sin(6*h)))/(i-2*e*Math.cos(2*h)+4*n*Math.cos(4*h)-6*a*Math.cos(6*h)),Math.abs(l)<=1e-10)return h;return NaN},je={init:function(){this.sphere||(this.e0=Tt(this.es),this.e1=Ct(this.es),this.e2=Dt(this.es),this.e3=Pt(this.es),this.ml0=this.a*X(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var i,e,n=t.x,a=t.y;if(n=C(n-this.long0),this.sphere)i=this.a*Math.asin(Math.cos(a)*Math.sin(n)),e=this.a*(Math.atan2(Math.tan(a),Math.cos(n))-this.lat0);else{var h=Math.sin(a),l=Math.cos(a),r=mt(this.a,this.e,h),d=Math.tan(a)*Math.tan(a),u=n*Math.cos(a),p=u*u,_=this.es*l*l/(1-this.es);i=r*u*(1-p*d*(1/6-(8-d+8*_)*p/120)),e=this.a*X(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+r*h/l*p*(.5+(5-d+6*_)*p/24)}return t.x=i+this.x0,t.y=e+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var i,e,n=t.x/this.a,a=t.y/this.a;if(this.sphere){var h=a+this.lat0;i=Math.asin(Math.sin(h)*Math.cos(n)),e=Math.atan2(Math.tan(n),Math.cos(h))}else{var r=Vt(this.ml0/this.a+a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(r)-y)<=k)return t.x=this.long0,t.y=y,a<0&&(t.y*=-1),t;var d=mt(this.a,this.e,Math.sin(r)),u=d*d*d/this.a/this.a*(1-this.es),p=Math.pow(Math.tan(r),2),_=n*this.a/d,m=_*_;i=r-d*Math.tan(r)/u*_*_*(.5-(1+3*p)*_*_/24),e=_*(1-m*(p/3+(1+3*p)*p*m/15))/Math.cos(r)}return t.x=C(e+this.long0),t.y=Mt(i),t},names:["Cassini","Cassini_Soldner","cass"]},at=function(t,i){var e;return t>1e-7?(1-t*t)*(i/(1-(e=t*i)*e)-.5/t*Math.log((1-e)/(1+e))):2*i},Je={init:function(){var i,t=Math.abs(this.lat0);if(this.mode=Math.abs(t-y)<k?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<k?this.EQUIT:this.OBLIQ,this.es>0)switch(this.qp=at(this.e,1),this.mmf=.5/(1-this.es),this.apa=function ce(t){var i,e=[];return e[0]=.3333333333333333*t,e[0]+=.17222222222222222*(i=t*t),e[1]=.06388888888888888*i,e[0]+=.10257936507936508*(i*=t),e[1]+=.0664021164021164*i,e[2]=.016415012942191543*i,e}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),i=Math.sin(this.lat0),this.sinb1=at(this.e,i)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*i*i)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var i,e,n,a,h,l,r,d,u,p,_=t.x,m=t.y;if(_=C(_-this.long0),this.sphere){if(h=Math.sin(m),p=Math.cos(m),n=Math.cos(_),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((e=this.mode===this.EQUIT?1+p*n:1+this.sinph0*h+this.cosph0*p*n)<=k)return null;i=(e=Math.sqrt(2/e))*p*Math.sin(_),e*=this.mode===this.EQUIT?h:this.cosph0*h-this.sinph0*p*n}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),Math.abs(m+this.lat0)<k)return null;e=G-.5*m,i=(e=2*(this.mode===this.S_POLE?Math.cos(e):Math.sin(e)))*Math.sin(_),e*=n}}else{switch(r=0,d=0,u=0,n=Math.cos(_),a=Math.sin(_),h=Math.sin(m),l=at(this.e,h),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(r=l/this.qp,d=Math.sqrt(1-r*r)),this.mode){case this.OBLIQ:u=1+this.sinb1*r+this.cosb1*d*n;break;case this.EQUIT:u=1+d*n;break;case this.N_POLE:u=y+m,l=this.qp-l;break;case this.S_POLE:u=m-y,l=this.qp+l}if(Math.abs(u)<k)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:u=Math.sqrt(2/u),e=this.mode===this.OBLIQ?this.ymf*u*(this.cosb1*r-this.sinb1*d*n):(u=Math.sqrt(2/(1+d*n)))*r*this.ymf,i=this.xmf*u*d*a;break;case this.N_POLE:case this.S_POLE:l>=0?(i=(u=Math.sqrt(l))*a,e=n*(this.mode===this.S_POLE?u:-u)):i=e=0}}return t.x=this.a*i+this.x0,t.y=this.a*e+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var i,e,n,a,h,l,r,d=t.x/this.a,u=t.y/this.a;if(this.sphere){var p,_=0,m=0;if((e=.5*(p=Math.sqrt(d*d+u*u)))>1)return null;switch(e=2*Math.asin(e),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(m=Math.sin(e),_=Math.cos(e)),this.mode){case this.EQUIT:e=Math.abs(p)<=k?0:Math.asin(u*m/p),d*=m,u=_*p;break;case this.OBLIQ:e=Math.abs(p)<=k?this.lat0:Math.asin(_*this.sinph0+u*m*this.cosph0/p),d*=m*this.cosph0,u=(_-Math.sin(e)*this.sinph0)*p;break;case this.N_POLE:u=-u,e=y-e;break;case this.S_POLE:e-=y}i=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(d,u):0}else{if(r=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(d/=this.dd,u*=this.dd,(l=Math.sqrt(d*d+u*u))<k)return t.x=this.long0,t.y=this.lat0,t;a=2*Math.asin(.5*l/this.rq),n=Math.cos(a),d*=a=Math.sin(a),this.mode===this.OBLIQ?(h=this.qp*(r=n*this.sinb1+u*a*this.cosb1/l),u=l*this.cosb1*n-u*this.sinb1*a):(h=this.qp*(r=u*a/l),u=l*n)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),!(h=d*d+u*u))return t.x=this.long0,t.y=this.lat0,t;r=1-h/this.qp,this.mode===this.S_POLE&&(r=-r)}i=Math.atan2(d,u),e=function de(t,i){var e=t+t;return t+i[0]*Math.sin(e)+i[1]*Math.sin(e+e)+i[2]*Math.sin(e+e+e)}(Math.asin(r),this.apa)}return t.x=C(this.long0+i),t.y=e,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},ot=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)},Ze={init:function(){Math.abs(this.lat1+this.lat2)<k||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=st(this.e3,this.sin_po,this.cos_po),this.qs1=at(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=st(this.e3,this.sin_po,this.cos_po),this.qs2=at(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=at(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>k?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var i=t.x,e=t.y;this.sin_phi=Math.sin(e),this.cos_phi=Math.cos(e);var n=at(this.e3,this.sin_phi),a=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,h=this.ns0*C(i-this.long0),l=a*Math.sin(h)+this.x0,r=this.rh-a*Math.cos(h)+this.y0;return t.x=l,t.y=r,t},inverse:function(t){var i,n,a,h,l;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),a=0,0!==i&&(a=Math.atan2(n*t.x,n*t.y)),n=i*this.ns0/this.a,l=this.sphere?Math.asin((this.c-n*n)/(2*this.ns0)):this.phi1z(this.e3,(this.c-n*n)/this.ns0),h=C(a/this.ns0+this.long0),t.x=h,t.y=l,t},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(t,i){var e,a,h,l,r=ot(.5*i);if(t<k)return r;for(var d=t*t,u=1;u<=25;u++)if(r+=l=.5*(h=1-(a=t*(e=Math.sin(r)))*a)*h/Math.cos(r)*(i/(1-d)-e/h+.5/t*Math.log((1-a)/(1+a))),Math.abs(l)<=1e-7)return r;return null}},Ke={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var i,e,n,a,h,l,r,u=t.y;return n=C(t.x-this.long0),i=Math.sin(u),e=Math.cos(u),a=Math.cos(n),(h=this.sin_p14*i+this.cos_p14*e*a)>0||Math.abs(h)<=k?(l=this.x0+1*this.a*e*Math.sin(n)/h,r=this.y0+1*this.a*(this.cos_p14*i-this.sin_p14*e*a)/h):(l=this.x0+this.infinity_dist*e*Math.sin(n),r=this.y0+this.infinity_dist*(this.cos_p14*i-this.sin_p14*e*a)),t.x=l,t.y=r,t},inverse:function(t){var i,e,n,a,h,l;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(i=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(i,this.rc),e=Math.sin(a),n=Math.cos(a),l=ot(n*this.sin_p14+t.y*e*this.cos_p14/i),h=Math.atan2(t.x*e,i*this.cos_p14*n-t.y*this.sin_p14*e),h=C(this.long0+h)):(l=this.phic0,h=0),t.x=h,t.y=l,t},names:["gnom"]},ts={init:function(){this.sphere||(this.k0=st(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var i,e,a=t.y,h=C(t.x-this.long0);if(this.sphere)i=this.x0+this.a*h*Math.cos(this.lat_ts),e=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var l=at(this.e,Math.sin(a));i=this.x0+this.a*this.k0*h,e=this.y0+this.a*l*.5/this.k0}return t.x=i,t.y=e,t},inverse:function(t){var i,e;return t.x-=this.x0,t.y-=this.y0,this.sphere?(i=C(this.long0+t.x/this.a/Math.cos(this.lat_ts)),e=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(e=function(t,i){var e=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(i)-e)<1e-6)return i<0?-1*y:y;for(var n,a,h,l,r=Math.asin(.5*i),d=0;d<30;d++)if(a=Math.sin(r),h=Math.cos(r),l=t*a,r+=n=Math.pow(1-l*l,2)/(2*h)*(i/(1-t*t)-a/(1-l*l)+.5/t*Math.log((1-l)/(1+l))),Math.abs(n)<=1e-10)return r;return NaN}(this.e,2*t.y*this.k0/this.a),i=C(this.long0+t.x/(this.a*this.k0))),t.x=i,t.y=e,t},names:["cea"]},is={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.y,n=C(t.x-this.long0),a=Mt(e-this.lat0);return t.x=this.x0+this.a*n*this.rc,t.y=this.y0+this.a*a,t},inverse:function(t){var e=t.y;return t.x=C(this.long0+(t.x-this.x0)/(this.a*this.rc)),t.y=Mt(this.lat0+(e-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},es={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Tt(this.es),this.e1=Ct(this.es),this.e2=Dt(this.es),this.e3=Pt(this.es),this.ml0=this.a*X(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var i,e,n,h=t.y,l=C(t.x-this.long0);if(n=l*Math.sin(h),this.sphere)Math.abs(h)<=k?(i=this.a*l,e=-1*this.a*this.lat0):(i=this.a*Math.sin(n)/Math.tan(h),e=this.a*(Mt(h-this.lat0)+(1-Math.cos(n))/Math.tan(h)));else if(Math.abs(h)<=k)i=this.a*l,e=-1*this.ml0;else{var r=mt(this.a,this.e,Math.sin(h))/Math.tan(h);i=r*Math.sin(n),e=this.a*X(this.e0,this.e1,this.e2,this.e3,h)-this.ml0+r*(1-Math.cos(n))}return t.x=i+this.x0,t.y=e+this.y0,t},inverse:function(t){var i,e,n,a,h,l,r,d,u;if(n=t.x-this.x0,a=t.y-this.y0,this.sphere)if(Math.abs(a+this.a*this.lat0)<=k)i=C(n/this.a+this.long0),e=0;else{var p;for(r=n*n/this.a/this.a+(l=this.lat0+a/this.a)*l,d=l,h=20;h;--h)if(d+=u=-1*(l*(d*(p=Math.tan(d))+1)-d-.5*(d*d+r)*p)/((d-l)/p-1),Math.abs(u)<=k){e=d;break}i=C(this.long0+Math.asin(n*Math.tan(d)/this.a)/Math.sin(e))}else if(Math.abs(a+this.ml0)<=k)e=0,i=C(this.long0+n/this.a);else{var _,m,v,M,x;for(r=n*n/this.a/this.a+(l=(this.ml0+a)/this.a)*l,d=l,h=20;h;--h)if(x=this.e*Math.sin(d),_=Math.sqrt(1-x*x)*Math.tan(d),m=this.a*X(this.e0,this.e1,this.e2,this.e3,d),v=this.e0-2*this.e1*Math.cos(2*d)+4*this.e2*Math.cos(4*d)-6*this.e3*Math.cos(6*d),d-=u=(l*(_*(M=m/this.a)+1)-M-.5*_*(M*M+r))/(this.es*Math.sin(2*d)*(M*M+r-2*l*M)/(4*_)+(l-M)*(_*v-2/Math.sin(2*d))-v),Math.abs(u)<=k){e=d;break}_=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e),i=C(this.long0+Math.asin(n*_/this.a)/Math.sin(e))}return t.x=i,t.y=e,t},names:["Polyconic","poly"]},ss={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var i,h=(t.y-this.lat0)/yt*1e-5,l=t.x-this.long0,r=1,d=0;for(i=1;i<=10;i++)d+=this.A[i]*(r*=h);var u,p=d,_=l,m=1,v=0,M=0,x=0;for(i=1;i<=6;i++)u=v*p+m*_,M=M+this.B_re[i]*(m=m*p-v*_)-this.B_im[i]*(v=u),x=x+this.B_im[i]*m+this.B_re[i]*v;return t.x=x*this.a+this.x0,t.y=M*this.a+this.y0,t},inverse:function(t){var i,e,l=(t.y-this.y0)/this.a,r=(t.x-this.x0)/this.a,d=1,u=0,p=0,_=0;for(i=1;i<=6;i++)e=u*l+d*r,p=p+this.C_re[i]*(d=d*l-u*r)-this.C_im[i]*(u=e),_=_+this.C_im[i]*d+this.C_re[i]*u;for(var m=0;m<this.iterations;m++){var v,M=p,x=_,A=l,P=r;for(i=2;i<=6;i++)v=x*p+M*_,A+=(i-1)*(this.B_re[i]*(M=M*p-x*_)-this.B_im[i]*(x=v)),P+=(i-1)*(this.B_im[i]*M+this.B_re[i]*x);M=1,x=0;var R=this.B_re[1],O=this.B_im[1];for(i=2;i<=6;i++)v=x*p+M*_,R+=i*(this.B_re[i]*(M=M*p-x*_)-this.B_im[i]*(x=v)),O+=i*(this.B_im[i]*M+this.B_re[i]*x);var B=R*R+O*O;p=(A*R+P*O)/B,_=(P*R-A*O)/B}var Q=p,j=_,nt=1,rt=0;for(i=1;i<=9;i++)rt+=this.D[i]*(nt*=Q);var ht=this.lat0+rt*yt*1e5;return t.x=this.long0+j,t.y=ht,t},names:["New_Zealand_Map_Grid","nzmg"]},as={init:function(){},forward:function(t){var e=t.y,n=C(t.x-this.long0),a=this.x0+this.a*n,h=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return t.x=a,t.y=h,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var i=C(this.long0+t.x/this.a),e=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=i,t.y=e,t},names:["Miller_Cylindrical","mill"]},ns={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Ci(this.es)},forward:function(t){var i,e,n=t.x,a=t.y;if(n=C(n-this.long0),this.sphere){if(this.m)for(var h=this.n*Math.sin(a),l=20;l;--l){var r=(this.m*a+Math.sin(a)-h)/(this.m+Math.cos(a));if(a-=r,Math.abs(r)<k)break}else a=1!==this.n?Math.asin(this.n*Math.sin(a)):a;i=this.a*this.C_x*n*(this.m+Math.cos(a)),e=this.a*this.C_y*a}else{var d=Math.sin(a),u=Math.cos(a);e=this.a*Bt(a,d,u,this.en),i=this.a*n*u/Math.sqrt(1-this.es*d*d)}return t.x=i,t.y=e,t},inverse:function(t){var i,e,n,a;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,i=t.y/this.a,this.sphere?(i/=this.C_y,n/=this.C_x*(this.m+Math.cos(i)),this.m?i=ot((this.m*i+Math.sin(i))/this.n):1!==this.n&&(i=ot(Math.sin(i)/this.n)),n=C(n+this.long0),i=Mt(i)):(i=Di(t.y/this.a,this.es,this.en),(a=Math.abs(i))<y?(a=Math.sin(i),e=this.long0+t.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(i)),n=C(e)):a-k<y&&(n=this.long0)),t.x=n,t.y=i,t},names:["Sinusoidal","sinu"]},rs={init:function(){},forward:function(t){for(var e=t.y,n=C(t.x-this.long0),a=e,h=Math.PI*Math.sin(e);;){var l=-(a+Math.sin(a)-h)/(1+Math.cos(a));if(a+=l,Math.abs(l)<k)break}a/=2,Math.PI/2-Math.abs(e)<k&&(n=0);var r=.900316316158*this.a*n*Math.cos(a)+this.x0,d=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=r,t.y=d,t},inverse:function(t){var i,e;t.x-=this.x0,t.y-=this.y0,e=t.y/(1.4142135623731*this.a),Math.abs(e)>.999999999999&&(e=.999999999999),i=Math.asin(e);var n=C(this.long0+t.x/(.900316316158*this.a*Math.cos(i)));n<-Math.PI&&(n=-Math.PI),n>Math.PI&&(n=Math.PI),e=(2*i+Math.sin(2*i))/Math.PI,Math.abs(e)>1&&(e=1);var a=Math.asin(e);return t.x=n,t.y=a,t},names:["Mollweide","moll"]},hs={init:function(){Math.abs(this.lat1+this.lat2)<k||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Tt(this.es),this.e1=Ct(this.es),this.e2=Dt(this.es),this.e3=Pt(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=st(this.e,this.sinphi,this.cosphi),this.ml1=X(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<k?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=st(this.e,this.sinphi,this.cosphi),this.ml2=X(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=X(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var i,e=t.x,n=t.y;if(this.sphere)i=this.a*(this.g-n);else{var a=X(this.e0,this.e1,this.e2,this.e3,n);i=this.a*(this.g-a)}var h=this.ns*C(e-this.long0),l=this.x0+i*Math.sin(h),r=this.y0+this.rh-i*Math.cos(h);return t.x=l,t.y=r,t},inverse:function(t){var i,e,n,a;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1);var h=0;return 0!==e&&(h=Math.atan2(i*t.x,i*t.y)),this.sphere?(a=C(this.long0+h/this.ns),n=Mt(this.g-e/this.a),t.x=a,t.y=n,t):(n=Vt(this.g-e/this.a,this.e0,this.e1,this.e2,this.e3),a=C(this.long0+h/this.ns),t.x=a,t.y=n,t)},names:["Equidistant_Conic","eqdc"]},ls={init:function(){this.R=this.a},forward:function(t){var i,e,a=t.y,h=C(t.x-this.long0);Math.abs(a)<=k&&(i=this.x0+this.R*h,e=this.y0);var l=ot(2*Math.abs(a/Math.PI));(Math.abs(h)<=k||Math.abs(Math.abs(a)-y)<=k)&&(i=this.x0,e=a>=0?this.y0+Math.PI*this.R*Math.tan(.5*l):this.y0+Math.PI*this.R*-Math.tan(.5*l));var r=.5*Math.abs(Math.PI/h-h/Math.PI),d=r*r,u=Math.sin(l),p=Math.cos(l),_=p/(u+p-1),v=_*(2/u-1),M=v*v,x=Math.PI*this.R*(r*(_-M)+Math.sqrt(d*(_-M)*(_-M)-(M+d)*(_*_-M)))/(M+d);h<0&&(x=-x),i=this.x0+x;var A=d+_;return x=Math.PI*this.R*(v*A-r*Math.sqrt((M+d)*(d+1)-A*A))/(M+d),e=a>=0?this.y0+x:this.y0-x,t.x=i,t.y=e,t},inverse:function(t){var i,e,n,a,h,l,r,d,u,p,_,m;return t.x-=this.x0,t.y-=this.y0,_=Math.PI*this.R,h=(n=t.x/_)*n+(a=t.y/_)*a,_=3*(a*a/(d=-2*(l=-Math.abs(a)*(1+h))+1+2*a*a+h*h)+(2*(r=l-2*a*a+n*n)*r*r/d/d/d-9*l*r/d/d)/27)/(u=(l-r*r/3/d)/d)/(p=2*Math.sqrt(-u/3)),Math.abs(_)>1&&(_=_>=0?1:-1),m=Math.acos(_)/3,e=t.y>=0?(-p*Math.cos(m+Math.PI/3)-r/3/d)*Math.PI:-(-p*Math.cos(m+Math.PI/3)-r/3/d)*Math.PI,i=Math.abs(n)<k?this.long0:C(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(n*n-a*a)+h*h))/2/n),t.x=i,t.y=e,t},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},cs={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(t){var i,e,n,a,h,l,r,d,u,p,_,m,v,M,x,A,P,R,O,B,Q,j,rt=t.x,ht=t.y,Lt=Math.sin(t.y),Ot=Math.cos(t.y),Z=C(rt-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=k?(t.x=this.x0+this.a*(y-ht)*Math.sin(Z),t.y=this.y0-this.a*(y-ht)*Math.cos(Z),t):Math.abs(this.sin_p12+1)<=k?(t.x=this.x0+this.a*(y+ht)*Math.sin(Z),t.y=this.y0+this.a*(y+ht)*Math.cos(Z),t):(R=this.sin_p12*Lt+this.cos_p12*Ot*Math.cos(Z),P=(A=Math.acos(R))?A/Math.sin(A):1,t.x=this.x0+this.a*P*Ot*Math.sin(Z),t.y=this.y0+this.a*P*(this.cos_p12*Lt-this.sin_p12*Ot*Math.cos(Z)),t):(i=Tt(this.es),e=Ct(this.es),n=Dt(this.es),a=Pt(this.es),Math.abs(this.sin_p12-1)<=k?(h=this.a*X(i,e,n,a,y),l=this.a*X(i,e,n,a,ht),t.x=this.x0+(h-l)*Math.sin(Z),t.y=this.y0-(h-l)*Math.cos(Z),t):Math.abs(this.sin_p12+1)<=k?(h=this.a*X(i,e,n,a,y),l=this.a*X(i,e,n,a,ht),t.x=this.x0+(h+l)*Math.sin(Z),t.y=this.y0+(h+l)*Math.cos(Z),t):(r=Lt/Ot,d=mt(this.a,this.e,this.sin_p12),u=mt(this.a,this.e,Lt),p=Math.atan((1-this.es)*r+this.es*d*this.sin_p12/(u*Ot)),O=0===(_=Math.atan2(Math.sin(Z),this.cos_p12*Math.tan(p)-this.sin_p12*Math.cos(Z)))?Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.abs(Math.abs(_)-Math.PI)<=k?-Math.asin(this.cos_p12*Math.sin(p)-this.sin_p12*Math.cos(p)):Math.asin(Math.sin(Z)*Math.cos(p)/Math.sin(_)),m=this.e*this.sin_p12/Math.sqrt(1-this.es),v=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es),t.x=this.x0+(A=d*O*(1-(B=O*O)*(x=v*v)*(1-x)/6+(Q=B*O)/8*(M=m*v)*(1-2*x)+(j=Q*O)/120*(x*(4-7*x)-3*m*m*(1-7*x))-j*O/48*M))*Math.sin(_),t.y=this.y0+A*Math.cos(_),t))},inverse:function(t){var i,e,n,a,h,l,r,d,u,p,_,m,M,x,A,P,R,O,B,Q,j,nt,rt;return t.x-=this.x0,t.y-=this.y0,this.sphere?(i=Math.sqrt(t.x*t.x+t.y*t.y))>2*y*this.a?void 0:(e=i/this.a,n=Math.sin(e),a=Math.cos(e),h=this.long0,Math.abs(i)<=k?l=this.lat0:(l=ot(a*this.sin_p12+t.y*n*this.cos_p12/i),r=Math.abs(this.lat0)-y,h=C(Math.abs(r)<=k?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*n,i*this.cos_p12*a-t.y*this.sin_p12*n))),t.x=h,t.y=l,t):(d=Tt(this.es),u=Ct(this.es),p=Dt(this.es),_=Pt(this.es),Math.abs(this.sin_p12-1)<=k?(m=this.a*X(d,u,p,_,y),i=Math.sqrt(t.x*t.x+t.y*t.y),l=Vt((m-i)/this.a,d,u,p,_),h=C(this.long0+Math.atan2(t.x,-1*t.y)),t.x=h,t.y=l,t):Math.abs(this.sin_p12+1)<=k?(m=this.a*X(d,u,p,_,y),i=Math.sqrt(t.x*t.x+t.y*t.y),l=Vt((i-m)/this.a,d,u,p,_),h=C(this.long0+Math.atan2(t.x,t.y)),t.x=h,t.y=l,t):(i=Math.sqrt(t.x*t.x+t.y*t.y),A=Math.atan2(t.x,t.y),M=mt(this.a,this.e,this.sin_p12),P=Math.cos(A),B=3*this.es*(1-(O=-(R=this.e*this.cos_p12*P)*R/(1-this.es)))*this.sin_p12*this.cos_p12*P/(1-this.es),nt=1-O*(j=(Q=i/M)-O*(1+O)*Math.pow(Q,3)/6-B*(1+3*O)*Math.pow(Q,4)/24)*j/2-Q*j*j*j/6,x=Math.asin(this.sin_p12*Math.cos(j)+this.cos_p12*Math.sin(j)*P),h=C(this.long0+Math.asin(Math.sin(A)*Math.sin(j)/Math.cos(x))),rt=Math.sin(x),l=Math.atan2((rt-this.es*nt*this.sin_p12)*Math.tan(x),rt*(1-this.es)),t.x=h,t.y=l,t))},names:["Azimuthal_Equidistant","aeqd"]},ds={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var i,e,n,a,h,l,r,u=t.y;return n=C(t.x-this.long0),i=Math.sin(u),e=Math.cos(u),a=Math.cos(n),((h=this.sin_p14*i+this.cos_p14*e*a)>0||Math.abs(h)<=k)&&(l=1*this.a*e*Math.sin(n),r=this.y0+1*this.a*(this.cos_p14*i-this.sin_p14*e*a)),t.x=l,t.y=r,t},inverse:function(t){var i,e,n,a,h,l,r;return t.x-=this.x0,t.y-=this.y0,i=Math.sqrt(t.x*t.x+t.y*t.y),e=ot(i/this.a),n=Math.sin(e),a=Math.cos(e),l=this.long0,Math.abs(i)<=k?(r=this.lat0,t.x=l,t.y=r,t):(r=ot(a*this.sin_p14+t.y*n*this.cos_p14/i),h=Math.abs(this.lat0)-y,Math.abs(h)<=k?(l=C(this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y)),t.x=l,t.y=r,t):(l=C(this.long0+Math.atan2(t.x*n,i*this.cos_p14*a-t.y*this.sin_p14*n)),t.x=l,t.y=r,t))},names:["ortho"]},z={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},us={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=y-G/2?5:this.lat0<=-(y-G/2)?6:Math.abs(this.long0)<=G?1:Math.abs(this.long0)<=y+G?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var i,e,n,a,h,l,r={x:0,y:0},d={value:0};if(t.x-=this.long0,i=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,e=t.x,5===this.face)a=y-i,e>=G&&e<=y+G?(d.value=z.AREA_0,n=e-y):e>y+G||e<=-(y+G)?(d.value=z.AREA_1,n=e>0?e-q:e+q):e>-(y+G)&&e<=-G?(d.value=z.AREA_2,n=e+y):(d.value=z.AREA_3,n=e);else if(6===this.face)a=y+i,e>=G&&e<=y+G?(d.value=z.AREA_0,n=-e+y):e<G&&e>=-G?(d.value=z.AREA_1,n=-e):e<-G&&e>=-(y+G)?(d.value=z.AREA_2,n=-e-y):(d.value=z.AREA_3,n=e>0?-e+q:-e-q);else{var u,p,_,m,v,M;2===this.face?e=pt(e,+y):3===this.face?e=pt(e,+q):4===this.face&&(e=pt(e,-y)),m=Math.sin(i),v=Math.cos(i),M=Math.sin(e),u=v*Math.cos(e),p=v*M,_=m,1===this.face?n=Rt(a=Math.acos(u),_,p,d):2===this.face?n=Rt(a=Math.acos(p),_,-u,d):3===this.face?n=Rt(a=Math.acos(-u),_,-p,d):4===this.face?n=Rt(a=Math.acos(-p),_,u,d):(a=n=0,d.value=z.AREA_0)}return l=Math.atan(12/q*(n+Math.acos(Math.sin(n)*Math.cos(G))-y)),h=Math.sqrt((1-Math.cos(a))/(Math.cos(l)*Math.cos(l))/(1-Math.cos(Math.atan(1/Math.cos(n))))),d.value===z.AREA_1?l+=y:d.value===z.AREA_2?l+=q:d.value===z.AREA_3&&(l+=1.5*q),r.x=h*Math.cos(l),r.y=h*Math.sin(l),r.x=r.x*this.a+this.x0,r.y=r.y*this.a+this.y0,t.x=r.x,t.y=r.y,t},inverse:function(t){var i,e,n,a,h,l,r,d,u,x,A,P,p={lam:0,phi:0},_={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,e=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),i=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?_.value=z.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(_.value=z.AREA_1,i-=y):t.x<0&&-t.x>=Math.abs(t.y)?(_.value=z.AREA_2,i=i<0?i+q:i-q):(_.value=z.AREA_3,i+=y),u=q/12*Math.tan(i),h=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),l=Math.atan(h),(r=1-(n=Math.cos(i))*n*(a=Math.tan(e))*a*(1-Math.cos(Math.atan(1/Math.cos(l)))))<-1?r=-1:r>1&&(r=1),5===this.face)d=Math.acos(r),p.phi=y-d,p.lam=_.value===z.AREA_0?l+y:_.value===z.AREA_1?l<0?l+q:l-q:_.value===z.AREA_2?l-y:l;else if(6===this.face)d=Math.acos(r),p.phi=d-y,p.lam=_.value===z.AREA_0?-l+y:_.value===z.AREA_1?-l:_.value===z.AREA_2?-l-y:l<0?-l-q:-l+q;else{var m,v,M;u=(m=r)*m,v=(u+=(M=u>=1?0:Math.sqrt(1-u)*Math.sin(l))*M)>=1?0:Math.sqrt(1-u),_.value===z.AREA_1?(u=v,v=-M,M=u):_.value===z.AREA_2?(v=-v,M=-M):_.value===z.AREA_3&&(u=v,v=M,M=-u),2===this.face?(u=m,m=-v,v=u):3===this.face?(m=-m,v=-v):4===this.face&&(u=m,m=v,v=-u),p.phi=Math.acos(-M)-y,p.lam=Math.atan2(v,m),2===this.face?p.lam=pt(p.lam,-y):3===this.face?p.lam=pt(p.lam,-q):4===this.face&&(p.lam=pt(p.lam,+y))}return 0!==this.es&&(x=p.phi<0?1:0,A=Math.tan(p.phi),P=this.b/Math.sqrt(A*A+this.one_minus_f_squared),p.phi=Math.atan(Math.sqrt(this.a*this.a-P*P)/(this.one_minus_f*P)),x&&(p.phi=-p.phi)),p.lam+=this.long0,t.x=p.lam,t.y=p.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},ei=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],St=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Ni=et/5,ps=1/Ni,Qt=function(t,i){return t[0]+i*(t[1]+i*(t[2]+i*t[3]))},fs={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var i=C(t.x-this.long0),e=Math.abs(t.y),n=Math.floor(e*Ni);n<0?n=0:n>=18&&(n=17);var a={x:Qt(ei[n],e=et*(e-ps*n))*i,y:Qt(St[n],e)};return t.y<0&&(a.y=-a.y),a.x=a.x*this.a*.8487+this.x0,a.y=a.y*this.a*1.3523+this.y0,a},inverse:function(t){var i={x:(t.x-this.x0)/(.8487*this.a),y:Math.abs(t.y-this.y0)/(1.3523*this.a)};if(i.y>=1)i.x/=ei[18][0],i.y=t.y<0?-y:y;else{var e=Math.floor(18*i.y);for(e<0?e=0:e>=18&&(e=17);;)if(St[e][0]>i.y)--e;else{if(!(St[e+1][0]<=i.y))break;++e}var n=St[e],a=5*(i.y-n[0])/(St[e+1][0]-n[0]);a=function ue(t,i,e,n){for(var a=i;n;--n){var h=t(a);if(a-=h,Math.abs(h)<e)break}return a}(function(h){return(Qt(n,h)-i.y)/function(t,i){return t[1]+i*(2*t[2]+3*i*t[3])}(n,h)},a,k,100),i.x/=Qt(ei[e],a),i.y=(5*e+a)*V,t.y<0&&(i.y=-i.y)}return i.x=C(i.x+this.long0),i},names:["Robinson","robin"]},ms={init:function(){this.name="geocent"},forward:function(t){return oi(t,this.es,this.a)},inverse:function(t){return ni(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},At={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}},Ms={init:function(){if(Object.keys(At).forEach(function(e){if(void 0===this[e])this[e]=At[e].def;else{if(At[e].num&&isNaN(this[e]))throw new Error("Invalid parameter value, must be numeric "+e+" = "+this[e]);At[e].num&&(this[e]=parseFloat(this[e]))}At[e].degrees&&(this[e]=this[e]*V)}.bind(this)),Math.abs(Math.abs(this.lat0)-y)<k?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<k?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,i=this.azi;this.cg=Math.cos(i),this.sg=Math.sin(i),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var i,e,l,r,n=Math.sin(t.y),a=Math.cos(t.y),h=Math.cos(t.x);switch(this.mode){case 3:e=this.sinph0*n+this.cosph0*a*h;break;case 2:e=a*h;break;case 1:e=-n;break;case 0:e=n}switch(i=(e=this.pn1/(this.p-e))*a*Math.sin(t.x),this.mode){case 3:e*=this.cosph0*n-this.sinph0*a*h;break;case 2:e*=n;break;case 0:e*=-a*h;break;case 1:e*=a*h}return i=(i*this.cg-e*this.sg)*this.cw*(r=1/((l=e*this.cg+i*this.sg)*this.sw*this.h1+this.cw)),e=l*r,t.x=i*this.a,t.y=e*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var i,e,n,a={x:t.x,y:t.y};t.x=(i=this.pn1*t.x*(n=1/(this.pn1-t.y*this.sw)))*this.cg+(e=this.pn1*t.y*this.cw*n)*this.sg,t.y=e*this.cg-i*this.sg;var h=jt(t.x,t.y);if(Math.abs(h)<k)a.x=0,a.y=t.y;else{var l,r;switch(r=1-h*h*this.pfact,r=(this.p-Math.sqrt(r))/(this.pn1/h+h/this.pn1),l=Math.sqrt(1-r*r),this.mode){case 3:a.y=Math.asin(l*this.sinph0+t.y*r*this.cosph0/h),t.y=(l-this.sinph0*Math.sin(a.y))*h,t.x*=r*this.cosph0;break;case 2:a.y=Math.asin(t.y*r/h),t.y=l*h,t.x*=r;break;case 0:a.y=Math.asin(l),t.y=-t.y;break;case 1:a.y=-Math.asin(l)}a.x=Math.atan2(t.x,t.y)}return t.x=a.x+this.long0,t.y=a.y,t},names:["Tilted_Perspective","tpers"]};return K.defaultDatum="WGS84",K.Proj=it,K.WGS84=new K.Proj("WGS84"),K.Point=ut,K.toPoint=bi,K.defs=g,K.nadgrid=function(t,i){var e=new DataView(i),n=function Fi(t){var i=t.getInt32(8,!1);return 11!==i&&(11!==(i=t.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(e),a=function Vi(t,i){return{nFields:t.getInt32(8,i),nSubgridFields:t.getInt32(24,i),nSubgrids:t.getInt32(40,i),shiftType:Wt(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,i),fromSemiMinorAxis:t.getFloat64(136,i),toSemiMajorAxis:t.getFloat64(152,i),toSemiMinorAxis:t.getFloat64(168,i)}}(e,n);a.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var h={header:a,subgrids:Qi(e,a,n)};return yi[t]=h,h},K.transform=Nt,K.mgrs=De,K.version="2.7.5",function(t){t.Proj.projections.add(Ht),t.Proj.projections.add(Ft),t.Proj.projections.add(Ne),t.Proj.projections.add(Ge),t.Proj.projections.add(ze),t.Proj.projections.add(Ue),t.Proj.projections.add(qe),t.Proj.projections.add(Be),t.Proj.projections.add(He),t.Proj.projections.add(je),t.Proj.projections.add(Je),t.Proj.projections.add(Ze),t.Proj.projections.add(Ke),t.Proj.projections.add(ts),t.Proj.projections.add(is),t.Proj.projections.add(es),t.Proj.projections.add(ss),t.Proj.projections.add(as),t.Proj.projections.add(ns),t.Proj.projections.add(rs),t.Proj.projections.add(hs),t.Proj.projections.add(ls),t.Proj.projections.add(cs),t.Proj.projections.add(ds),t.Proj.projections.add(us),t.Proj.projections.add(fs),t.Proj.projections.add(ms),t.Proj.projections.add(Ms)}(K),K}),function(D){var N,E;if("function"==typeof define&&define.amd)define(["leaflet","proj4"],D);else if("object"==typeof module&&"object"==typeof module.exports)N=require("leaflet"),E=require("proj4"),module.exports=D(N,E);else{if(typeof window.L>"u"||typeof window.proj4>"u")throw"Leaflet and proj4 must be loaded first";D(window.L,window.proj4)}}(function(D,N){return N.__esModule&&N.default&&(N=N.default),D.Proj={},D.Proj._isProj4Obj=function(E){return typeof E.inverse<"u"&&typeof E.forward<"u"},D.Proj.Projection=D.Class.extend({initialize:function(E,b,s){var o=D.Proj._isProj4Obj(E);this._proj=o?E:this._projFromCodeDef(E,b),this.bounds=o?b:s},project:function(E){var b=this._proj.forward([E.lng,E.lat]);return new D.Point(b[0],b[1])},unproject:function(E,b){var s=this._proj.inverse([E.x,E.y]);return new D.LatLng(s[1],s[0],b)},_projFromCodeDef:function(E,b){if(b)N.defs(E,b);else if(void 0===N.defs[E]){var s=E.split(":");if(s.length>3&&(E=s[s.length-3]+":"+s[s.length-1]),void 0===N.defs[E])throw"No projection definition for code "+E}return N(E)}}),D.Proj.CRS=D.Class.extend({includes:D.CRS,options:{transformation:new D.Transformation(1,0,-1,0)},initialize:function(E,b,s){var o,c,g;if(D.Proj._isProj4Obj(E)?(o=(c=E).srsCode,this.projection=new D.Proj.Projection(c,(g=b||{}).bounds)):this.projection=new D.Proj.Projection(o=E,b,(g=s||{}).bounds),D.Util.setOptions(this,g),this.code=o,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new D.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var w=this.options.resolutions.length-1;w>=0;w--)this.options.resolutions[w]&&(this._scales[w]=1/this.options.resolutions[w])}this.infinite=!this.options.bounds},scale:function(E){var s,b=Math.floor(E);return E===b?this._scales[E]:(s=this._scales[b])+(this._scales[b+1]-s)*(E-b)},zoom:function(E){var o,b=this._closestElement(this._scales,E),s=this._scales.indexOf(b);return E===b?s:void 0===b?-1/0:void 0===(o=this._scales[s+1])?1/0:(E-b)/(o-b)+s},distance:D.CRS.Earth.distance,R:D.CRS.Earth.R,_closestElement:function(E,b){for(var s,o=E.length;o--;)E[o]<=b&&(void 0===s||s<E[o])&&(s=E[o]);return s}}),D.Proj.GeoJSON=D.GeoJSON.extend({initialize:function(E,b){this._callLevel=0,D.GeoJSON.prototype.initialize.call(this,E,b)},addData:function(E){var b;E&&(E.crs&&"name"===E.crs.type?b=new D.Proj.CRS(E.crs.properties.name):E.crs&&E.crs.type&&(b=new D.Proj.CRS(E.crs.type+":"+E.crs.properties.code)),void 0!==b&&(this.options.coordsToLatLng=function(s){var o=D.point(s[0],s[1]);return b.projection.unproject(o)})),this._callLevel++;try{D.GeoJSON.prototype.addData.call(this,E)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}}),D.Proj.geoJson=function(E,b){return new D.Proj.GeoJSON(E,b)},D.Proj.ImageOverlay=D.ImageOverlay.extend({initialize:function(E,b,s){D.ImageOverlay.prototype.initialize.call(this,E,null,s),this._projectedBounds=b},_animateZoom:function(E){var b=this._map.getZoomScale(E.zoom),s=D.point(this._projectedBounds.min.x,this._projectedBounds.max.y),o=this._projectedToNewLayerPoint(s,E.zoom,E.center);D.DomUtil.setTransform(this._image,o,b)},_reset:function(){var E=this._map.getZoom(),b=this._map.getPixelOrigin(),s=D.bounds(this._transform(this._projectedBounds.min,E)._subtract(b),this._transform(this._projectedBounds.max,E)._subtract(b)),o=s.getSize();D.DomUtil.setPosition(this._image,s.min),this._image.style.width=o.x+"px",this._image.style.height=o.y+"px"},_projectedToNewLayerPoint:function(E,b,s){var o=this._map.getSize()._divideBy(2),f=this._map.project(s,b)._subtract(o)._round().add(this._map._getMapPanePos());return this._transform(E,b)._subtract(f)},_transform:function(E,b){var s=this._map.options.crs,o=s.transformation,c=s.scale(b);return o.transform(E,c)}}),D.Proj.imageOverlay=function(E,b,s){return new D.Proj.ImageOverlay(E,b,s)},D.Proj}),function(D,N,E){var s;L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(s,o){this._map=s,this._container=s._container,this._overlayPane=s._panes.overlayPane,this._popupPane=s._panes.popupPane,o&&o.shapeOptions&&(o.shapeOptions=L.Util.extend({},this.options.shapeOptions,o.shapeOptions)),L.setOptions(this,o);var c=L.version.split(".");1===parseInt(c[0],10)&&parseInt(c[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(L.DomUtil.disableTextSelection(),s.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(s){L.setOptions(this,s)},_fireCreatedEvent:function(s){this._map.fire(L.Draw.Event.CREATED,{layer:s,layerType:this.type})},_cancelDrawing:function(s){27===s.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(s,o){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,o&&o.drawError&&(o.drawError=L.Util.extend({},this.options.drawError,o.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,s,o)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var s=this._markers.pop(),o=this._poly,c=o.getLatLngs(),f=c.splice(-1,1)[0];this._poly.setLatLngs(c),this._markerGroup.removeLayer(s),o.getLatLngs().length<2&&this._map.removeLayer(o),this._vertexChanged(f,!1)}},addVertex:function(s){this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(s)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(s)),this._poly.addLatLng(s),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(s,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var s=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),o=this._poly.newLatLngIntersects(s[s.length-1]);!this.options.allowIntersection&&o||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(s){var o=this._map.mouseEventToLayerPoint(s.originalEvent),c=this._map.layerPointToLatLng(o);this._currentLatLng=c,this._updateTooltip(c),this._updateGuide(o),this._mouseMarker.setLatLng(c),L.DomEvent.preventDefault(s.originalEvent)},_vertexChanged:function(s,o){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(s,o),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(s){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(s),this._clickHandled=!0,this._disableNewMarkers();var o=s.originalEvent;this._startPoint.call(this,o.clientX,o.clientY)}},_startPoint:function(s,o){this._mouseDownOrigin=L.point(s,o)},_onMouseUp:function(s){var o=s.originalEvent;this._endPoint.call(this,o.clientX,o.clientY,s),this._clickHandled=null},_endPoint:function(s,o,c){if(this._mouseDownOrigin){var f=L.point(s,o).distanceTo(this._mouseDownOrigin),g=this._calculateFinishDistance(c.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(c.latlng),this._finishShape()):g<10&&L.Browser.touch?this._finishShape():Math.abs(f)<9*(D.devicePixelRatio||1)&&this.addVertex(c.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(s){var o,c,f=s.originalEvent;!f.touches||!f.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(o=f.touches[0].clientX,c=f.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,o,c),this._endPoint.call(this,o,c,s),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(s){var o;if(this._markers.length>0){var c;if(this.type===L.Draw.Polyline.TYPE)c=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;c=this._markers[0]}var f=this._map.latLngToContainerPoint(c.getLatLng()),g=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),w=this._map.latLngToContainerPoint(g.getLatLng());o=f.distanceTo(w)}else o=1/0;return o},_updateFinishHandler:function(){var s=this._markers.length;s>1&&this._markers[s-1].on("click",this._finishShape,this),s>2&&this._markers[s-2].off("click",this._finishShape,this)},_createMarker:function(s){var o=new L.Marker(s,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(o),o},_updateGuide:function(s){var o=this._markers?this._markers.length:0;o>0&&(s=s||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[o-1].getLatLng()),s))},_updateTooltip:function(s){var o=this._getTooltipText();s&&this._tooltip.updatePosition(s),this._errorShown||this._tooltip.updateContent(o)},_drawGuide:function(s,o){var c,f,g,w=Math.floor(Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2))),I=this.options.maxGuideLineLength,H=w>I?w-I:this.options.guidelineDistance;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));H<w;H+=this.options.guidelineDistance)c=H/w,f={x:Math.floor(s.x*(1-c)+c*o.x),y:Math.floor(s.y*(1-c)+c*o.y)},(g=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(g,f)},_updateGuideColor:function(s){if(this._guidesContainer)for(var o=0,c=this._guidesContainer.childNodes.length;o<c;o++)this._guidesContainer.childNodes[o].style.backgroundColor=s},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var s,o;return 0===this._markers.length?s={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(o=this.options.showLength?this._getMeasurementString():"",s=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:o}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:o}),s},_updateRunningMeasure:function(s,o){var c,f,g=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(c=g-(o?2:1),f=L.GeometryUtil.isVersion07x()?s.distanceTo(this._markers[c].getLatLng())*(this.options.factor||1):this._map.distance(s,this._markers[c].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=f*(o?1:-1))},_getMeasurementString:function(){var s,o=this._currentLatLng,c=this._markers[this._markers.length-1].getLatLng();return s=L.GeometryUtil.isVersion07x()?c&&o&&o.distanceTo?this._measurementRunningTotal+o.distanceTo(c)*(this.options.factor||1):this._measurementRunningTotal||0:c&&o?this._measurementRunningTotal+this._map.distance(o,c)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(s,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var s=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(s,o){L.Draw.Polyline.prototype.initialize.call(this,s,o),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var s=this._markers.length;1===s&&this._markers[0].on("click",this._finishShape,this),s>2&&(this._markers[s-1].on("dblclick",this._finishShape,this),s>3&&this._markers[s-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var s,o;return 0===this._markers.length?s=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(s=L.drawLocal.draw.handlers.polygon.tooltip.cont,o=this._getMeasurementString()):(s=L.drawLocal.draw.handlers.polygon.tooltip.end,o=this._getMeasurementString()),{text:s,subtext:o}},_getMeasurementString:function(){var s=this._area,o="";return s||this.options.showLength?(this.options.showLength&&(o=L.Draw.Polyline.prototype._getMeasurementString.call(this)),s&&(o+="<br>"+L.GeometryUtil.readableArea(s,this.options.metric,this.options.precision)),o):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(s,o){var c;!this.options.allowIntersection&&this.options.showArea&&(c=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(c)),L.Draw.Polyline.prototype._vertexChanged.call(this,s,o)},_cleanUpShape:function(){var s=this._markers.length;s>0&&(this._markers[0].off("click",this._finishShape,this),s>2&&this._markers[s-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(s,o){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,s,o)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),N.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(N,"mouseup",this._onMouseUp,this),L.DomEvent.off(N,"touchend",this._onMouseUp,this),N.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(s){this._isDrawing=!0,this._startLatLng=s.latlng,L.DomEvent.on(N,"mouseup",this._onMouseUp,this).on(N,"touchend",this._onMouseUp,this).preventDefault(s.originalEvent)},_onMouseMove:function(s){var o=s.latlng;this._tooltip.updatePosition(o),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(o))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(s,o){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,o)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(s){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!function b(s,o){for(;(s=s.parentElement)&&!s.classList.contains(o););return s}(s.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(s){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,s)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,s),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_getTooltipText:function(){var s,o,c,f=L.Draw.SimpleShape.prototype._getTooltipText.call(this),w=this.options.showArea;return this._shape&&(s=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),o=L.GeometryUtil.geodesicArea(s),c=w?L.GeometryUtil.readableArea(o,this.options.metric):""),{text:f.text,subtext:c}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(s,o){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,o)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(s){var o=s.latlng;this._tooltip.updatePosition(o),this._mouseMarker.setLatLng(o),this._marker?(o=this._mouseMarker.getLatLng(),this._marker.setLatLng(o)):(this._marker=this._createMarker(o),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(s){return new L.Marker(s,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(s){this._onMouseMove(s),this._onClick()},_fireCreatedEvent:function(){var s=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(s,o){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,s,o)},_fireCreatedEvent:function(){var s=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,s)},_createMarker:function(s){return new L.CircleMarker(s,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(s,o){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,s,o)},_drawShape:function(s){if(L.GeometryUtil.isVersion07x())var o=this._startLatLng.distanceTo(s);else o=this._map.distance(this._startLatLng,s);this._shape?this._shape.setRadius(o):(this._shape=new L.Circle(this._startLatLng,o,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var s=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,s)},_onMouseMove:function(s){var o,c=s.latlng,f=this.options.showRadius,g=this.options.metric;if(this._tooltip.updatePosition(c),this._isDrawing){this._drawShape(c),o=this._shape.getRadius().toFixed(1);var w="";f&&(w=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(o,g,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:w})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(s,o){this._marker=s,L.setOptions(this,o)},addHooks:function(){var s=this._marker;s.dragging.enable(),s.on("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},removeHooks:function(){var s=this._marker;s.dragging.disable(),s.off("dragend",this._onDragEnd,s),this._toggleMarkerHighlight()},_onDragEnd:function(s){var o=s.target;o.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:o})},_toggleMarkerHighlight:function(){var s=this._marker._icon;s&&(s.style.display="none",L.DomUtil.hasClass(s,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,-4)):(L.DomUtil.addClass(s,"leaflet-edit-marker-selected"),this._offsetMarker(s,4)),s.style.display="")},_offsetMarker:function(s,o){var c=parseInt(s.style.marginTop,10)-o,f=parseInt(s.style.marginLeft,10)-o;s.style.marginTop=c+"px",s.style.marginLeft=f+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(s){this.latlngs=[s._latlngs],s._holes&&(this.latlngs=this.latlngs.concat(s._holes)),this._poly=s,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(s){for(var o=0;o<this._verticesHandlers.length;o++)s(this._verticesHandlers[o])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(s){s.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(s){s.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(s){s.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var s=0;s<this.latlngs.length;s++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[s],this._poly.options.poly))},_updateLatLngs:function(s){this.latlngs=[s.layer._latlngs],s.layer._holes&&(this.latlngs=this.latlngs.concat(s.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(s,o,c){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=s,c&&c.drawError&&(c.drawError=L.Util.extend({},this.options.drawError,c.drawError)),this._latlngs=o,L.setOptions(this,c)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var s=this._poly,o=s._path;s instanceof L.Polygon||(s.options.fill=!1,s.options.editing&&(s.options.editing.fill=!1)),o&&s.options.editing&&s.options.editing.className&&(s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.removeClass(o,c)}),s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.addClass(o,c)})),s.setStyle(s.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var s=this._poly,o=s._path;o&&s.options.editing&&s.options.editing.className&&(s.options.editing.className.split(" ").forEach(function(c){L.DomUtil.removeClass(o,c)}),s.options.original.className&&s.options.original.className.split(" ").forEach(function(c){L.DomUtil.addClass(o,c)})),s.setStyle(s.options.original),s._map&&(s._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var s,o,c,f,w,T,g=this._defaultShape();for(s=0,c=g.length;s<c;s++)(f=this._createMarker(g[s],s)).on("click",this._onMarkerClick,this),f.on("contextmenu",this._onContextMenu,this),this._markers.push(f);for(s=0,o=c-1;s<c;o=s++)(0!==s||L.Polygon&&this._poly instanceof L.Polygon)&&(this._createMiddleMarker(w=this._markers[o],T=this._markers[s]),this._updatePrevNext(w,T))},_createMarker:function(s,o){var c=new L.Marker.Touch(s,{draggable:!0,icon:this.options.icon});return c._origLatLng=s,c._index=o,c.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(c),c},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var s=this._defaultShape(),o=[].splice.apply(s,arguments);return this._poly._convertLatLngs(s,!0),this._poly.redraw(),o},_removeMarker:function(s){var o=s._index;this._markerGroup.removeLayer(s),this._markers.splice(o,1),this._spliceLatLngs(o,1),this._updateIndexes(o,-1),s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(s){var o=s.target,c=this._poly,f=L.LatLngUtil.cloneLatLng(o._origLatLng);if(L.extend(o._origLatLng,o._latlng),c.options.poly){var g=c._map._editTooltip;if(!c.options.poly.allowIntersection&&c.intersects()){L.extend(o._origLatLng,f),o.setLatLng(f);var w=c.options.color;c.setStyle({color:this.options.drawError.color}),g&&g.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){c.setStyle({color:w}),g&&g.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}o._middleLeft&&o._middleLeft.setLatLng(this._getMiddleLatLng(o._prev,o)),o._middleRight&&o._middleRight.setLatLng(this._getMiddleLatLng(o,o._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var T=this._poly.getLatLngs();this._poly._convertLatLngs(T,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(s){var o=L.Polygon&&this._poly instanceof L.Polygon?4:3,c=s.target;this._defaultShape().length<o||(this._removeMarker(c),this._updatePrevNext(c._prev,c._next),c._middleLeft&&this._markerGroup.removeLayer(c._middleLeft),c._middleRight&&this._markerGroup.removeLayer(c._middleRight),c._prev&&c._next?this._createMiddleMarker(c._prev,c._next):c._prev?c._next||(c._prev._middleRight=null):c._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(s){this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:s.target,layers:this._markerGroup,poly:this._poly}),L},_onTouchMove:function(s){var o=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(o),f=s.target;L.extend(f._origLatLng,c),f._middleLeft&&f._middleLeft.setLatLng(this._getMiddleLatLng(f._prev,f)),f._middleRight&&f._middleRight.setLatLng(this._getMiddleLatLng(f,f._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(s,o){this._markerGroup.eachLayer(function(c){c._index>s&&(c._index+=o)})},_createMiddleMarker:function(s,o){var c,f,g,w=this._getMiddleLatLng(s,o),T=this._createMarker(w);T.setOpacity(.6),s._middleRight=o._middleLeft=T,f=function(){T.off("touchmove",f,this);var I=o._index;T._index=I,T.off("click",c,this).on("click",this._onMarkerClick,this),w.lat=T.getLatLng().lat,w.lng=T.getLatLng().lng,this._spliceLatLngs(I,0,w),this._markers.splice(I,0,T),T.setOpacity(1),this._updateIndexes(I,1),o._index++,this._updatePrevNext(s,T),this._updatePrevNext(T,o),this._poly.fire("editstart")},g=function(){T.off("dragstart",f,this),T.off("dragend",g,this),T.off("touchmove",f,this),this._createMiddleMarker(s,T),this._createMiddleMarker(T,o)},T.on("click",c=function(){f.call(this),g.call(this),this._fireEdit()},this).on("dragstart",f,this).on("dragend",g,this).on("touchmove",f,this),this._markerGroup.addLayer(T)},_updatePrevNext:function(s,o){s&&(s._next=o),o&&(o._prev=s)},_getMiddleLatLng:function(s,o){var c=this._poly._map,f=c.project(s.getLatLng()),g=c.project(o.getLatLng());return c.unproject(f._add(g)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(s,o){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=s,L.Util.setOptions(this,o)},addHooks:function(){var s=this._shape;this._shape._map&&(this._map=this._shape._map,s.setStyle(s.options.editing),s._map&&(this._map=s._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var s=this._shape;if(s.setStyle(s.options.original),s._map){this._unbindMarker(this._moveMarker);for(var o=0,c=this._resizeMarkers.length;o<c;o++)this._unbindMarker(this._resizeMarkers[o]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(s,o){var c=new L.Marker.Touch(s,{draggable:!0,icon:o,zIndexOffset:10});return this._bindMarker(c),this._markerGroup.addLayer(c),c},_bindMarker:function(s){s.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(s){s.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(s){s.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(s){var o=s.target,c=o.getLatLng();o===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(s){s.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(s){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s),"function"==typeof this._getCorners){var o=this._getCorners(),c=s.target,f=c._cornerIndex;c.setOpacity(0),this._oppositeCorner=o[(f+2)%4],this._toggleCornerMarkers(0,f)}this._shape.fire("editstart")},_onTouchMove:function(s){var o=this._map.mouseEventToLayerPoint(s.originalEvent.touches[0]),c=this._map.layerPointToLatLng(o);return s.target===this._moveMarker?this._move(c):this._resize(c),this._shape.redraw(),!1},_onTouchEnd:function(s){s.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var o=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(o,this.options.moveIcon)},_createResizeMarker:function(){var s=this._getCorners();this._resizeMarkers=[];for(var o=0,c=s.length;o<c;o++)this._resizeMarkers.push(this._createMarker(s[o],this.options.resizeIcon)),this._resizeMarkers[o]._cornerIndex=o},_onMarkerDragStart:function(s){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,s);var o=this._getCorners(),f=s.target._cornerIndex;this._oppositeCorner=o[(f+2)%4],this._toggleCornerMarkers(0,f)},_onMarkerDragEnd:function(s){var c,f=s.target;f===this._moveMarker&&(c=this._shape.getBounds().getCenter(),f.setLatLng(c)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,s)},_move:function(s){for(var o,c=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),g=this._shape.getBounds().getCenter(),w=[],T=0,I=c.length;T<I;T++)w.push([s.lat+(o=[c[T].lat-g.lat,c[T].lng-g.lng])[0],s.lng+o[1]]);this._shape.setLatLngs(w),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(s){var o;this._shape.setBounds(L.latLngBounds(s,this._oppositeCorner)),o=this._shape.getBounds(),this._moveMarker.setLatLng(o.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var s=this._shape.getBounds();return[s.getNorthWest(),s.getNorthEast(),s.getSouthEast(),s.getSouthWest()]},_toggleCornerMarkers:function(s){for(var o=0,c=this._resizeMarkers.length;o<c;o++)this._resizeMarkers[o].setOpacity(s)},_repositionCornerMarkers:function(){for(var s=this._getCorners(),o=0,c=this._resizeMarkers.length;o<c;o++)this._resizeMarkers[o].setLatLng(s[o])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var s=this._shape.getLatLng();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(s){if(this._resizeMarkers.length){var o=this._getResizeMarkerPoint(s);this._resizeMarkers[0].setLatLng(o)}this._shape.setLatLng(s),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var s=this._shape.getLatLng(),o=this._getResizeMarkerPoint(s);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(o,this.options.resizeIcon))},_getResizeMarkerPoint:function(s){var o=this._shape._radius*Math.cos(Math.PI/4),c=this._map.project(s);return this._map.unproject([c.x+o,c.y-o])},_resize:function(s){var o=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=o.distanceTo(s):radius=this._map.distance(o,s),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(s,o){var c={};if(void 0!==s.touches){if(!s.touches.length)return;c=s.touches[0]}else if("touch"!==s.pointerType||(c=s,!this._filterClick(s)))return;var f=this._map.mouseEventToContainerPoint(c),g=this._map.mouseEventToLayerPoint(c),w=this._map.layerPointToLatLng(g);this._map.fire(o,{latlng:w,layerPoint:g,containerPoint:f,pageX:c.pageX,pageY:c.pageY,originalEvent:s})},_filterClick:function(s){var o=s.timeStamp||s.originalEvent.timeStamp,c=L.DomEvent._lastClick&&o-L.DomEvent._lastClick;return c&&c>100&&c<500||s.target._simulatedClick&&!s._simulated?(L.DomEvent.stop(s),!1):(L.DomEvent._lastClick=o,!0)},_onTouchStart:function(s){this._map._loaded&&this._touchEvent(s,"touchstart")},_onTouchEnd:function(s){this._map._loaded&&this._touchEvent(s,"touchend")},_onTouchCancel:function(s){if(this._map._loaded){var o="touchcancel";this._detectIE()&&(o="pointercancel"),this._touchEvent(s,o)}},_onTouchLeave:function(s){this._map._loaded&&this._touchEvent(s,"touchleave")},_onTouchMove:function(s){this._map._loaded&&this._touchEvent(s,"touchmove")},_detectIE:function(){var s=D.navigator.userAgent,o=s.indexOf("MSIE ");if(o>0)return parseInt(s.substring(o+5,s.indexOf(".",o)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var f=s.indexOf("Edge/");return f>0&&parseInt(s.substring(f+5,s.indexOf(".",f)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var s=this._icon,o=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];o.concat(this._detectIE?["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]:["touchcancel"]),L.DomUtil.addClass(s,"leaflet-clickable"),L.DomEvent.on(s,"click",this._onMouseClick,this),L.DomEvent.on(s,"keypress",this._onKeyPress,this);for(var c=0;c<o.length;c++)L.DomEvent.on(s,o[c],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var s=D.navigator.userAgent,o=s.indexOf("MSIE ");if(o>0)return parseInt(s.substring(o+5,s.indexOf(".",o)),10);if(s.indexOf("Trident/")>0){var c=s.indexOf("rv:");return parseInt(s.substring(c+3,s.indexOf(".",c)),10)}var f=s.indexOf("Edge/");return f>0&&parseInt(s.substring(f+5,s.indexOf(".",f)),10)}}),L.LatLngUtil={cloneLatLngs:function(s){for(var o=[],c=0,f=s.length;c<f;c++)Array.isArray(s[c])?o.push(L.LatLngUtil.cloneLatLngs(s[c])):o.push(this.cloneLatLng(s[c]));return o},cloneLatLng:function(s){return L.latLng(s.lat,s.lng)}},s={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(o){var c,f,g=o.length,w=0,T=Math.PI/180;if(g>2){for(var I=0;I<g;I++)w+=((f=o[(I+1)%g]).lng-(c=o[I]).lng)*T*(2+Math.sin(c.lat*T)+Math.sin(f.lat*T));w=6378137*w*6378137/2}return Math.abs(w)},formattedNumber:function(o,c){var f=parseFloat(o).toFixed(c),g=L.drawLocal.format&&L.drawLocal.format.numeric,w=g&&g.delimiters,T=w&&w.thousands,I=w&&w.decimal;if(T||I){var H=f.split(".");f=T?H[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+T):H[0],I=I||".",H.length>1&&(f=f+I+H[1])}return f},readableArea:function(o,c,T){var g,w;return T=L.Util.extend({},s,T),c?(w=["ha","m"],type=typeof c,"string"===type?w=[c]:"boolean"!==type&&(w=c),g=o>=1e6&&-1!==w.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*o,T.km)+" km\xb2":o>=1e4&&-1!==w.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*o,T.ha)+" ha":L.GeometryUtil.formattedNumber(o,T.m)+" m\xb2"):g=(o/=.836127)>=3097600?L.GeometryUtil.formattedNumber(o/3097600,T.mi)+" mi\xb2":o>=4840?L.GeometryUtil.formattedNumber(o/4840,T.ac)+" acres":L.GeometryUtil.formattedNumber(o,T.yd)+" yd\xb2",g},readableDistance:function(o,c,f,g,I){var T;switch(I=L.Util.extend({},s,I),c?"string"==typeof c?c:"metric":f?"feet":g?"nauticalMile":"yards"){case"metric":T=o>1e3?L.GeometryUtil.formattedNumber(o/1e3,I.km)+" km":L.GeometryUtil.formattedNumber(o,I.m)+" m";break;case"feet":o*=3.28083,T=L.GeometryUtil.formattedNumber(o,I.ft)+" ft";break;case"nauticalMile":o*=.53996,T=L.GeometryUtil.formattedNumber(o/1e3,I.nm)+" nm";break;default:T=(o*=1.09361)>1760?L.GeometryUtil.formattedNumber(o/1760,I.mi)+" miles":L.GeometryUtil.formattedNumber(o,I.yd)+" yd"}return T},isVersion07x:function(){var o=L.version.split(".");return 0===parseInt(o[0],10)&&7===parseInt(o[1],10)}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(s,o,c,f){return this._checkCounterclockwise(s,c,f)!==this._checkCounterclockwise(o,c,f)&&this._checkCounterclockwise(s,o,c)!==this._checkCounterclockwise(s,o,f)},_checkCounterclockwise:function(s,o,c){return(c.y-s.y)*(o.x-s.x)>(o.y-s.y)*(c.x-s.x)}}),L.Polyline.include({intersects:function(){var s,f=this._getProjectedPoints(),g=f?f.length:0;if(this._tooFewPointsForIntersection())return!1;for(s=g-1;s>=3;s--)if(this._lineSegmentsIntersectsRange(f[s-1],f[s],s-2))return!0;return!1},newLatLngIntersects:function(s,o){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(s),o)},newPointIntersects:function(s,o){var c=this._getProjectedPoints(),f=c?c.length:0,g=c?c[f-1]:null,w=f-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(g,s,w,o?1:0)},_tooFewPointsForIntersection:function(s){var o=this._getProjectedPoints(),c=o?o.length:0;return!o||(c+=s||0)<=3},_lineSegmentsIntersectsRange:function(s,o,c,f){var T=this._getProjectedPoints();f=f||0;for(var I=c;I>f;I--)if(L.LineUtil.segmentsIntersect(s,o,T[I-1],T[I]))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var s=[],o=this._defaultShape(),c=0;c<o.length;c++)s.push(this._map.latLngToLayerPoint(o[c]));return s}}),L.Polygon.include({intersects:function(){var s,g=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||this._lineSegmentsIntersectsRange(g[(s=g.length)-1],g[0],s-2,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(s){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var o;L.Control.prototype.initialize.call(this,s),this._toolbars={},L.DrawToolbar&&this.options.draw&&(o=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=o,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(o=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=o,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(s){var o,c=L.DomUtil.create("div","leaflet-draw"),f=!1;for(var g in this._toolbars)this._toolbars.hasOwnProperty(g)&&(o=this._toolbars[g].addToolbar(s))&&(f||(L.DomUtil.hasClass(o,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(o.childNodes[0],"leaflet-draw-toolbar-top"),f=!0),c.appendChild(o));return c},onRemove:function(){for(var s in this._toolbars)this._toolbars.hasOwnProperty(s)&&this._toolbars[s].removeToolbar()},setDrawingOptions:function(s){for(var o in this._toolbars)this._toolbars[o]instanceof L.DrawToolbar&&this._toolbars[o].setOptions(s)},_toolbarEnabled:function(s){var o=s.target;for(var c in this._toolbars)this._toolbars[c]!==o&&this._toolbars[c].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(s){L.setOptions(this,s),this._modes={},this._actionButtons=[],this._activeMode=null;var o=L.version.split(".");1===parseInt(o[0],10)&&parseInt(o[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(s){var o,c=L.DomUtil.create("div","leaflet-draw-section"),f=0,g=this._toolbarClass||"",w=this.getModeHandlers(s);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=s,o=0;o<w.length;o++)w[o].enabled&&this._initModeHandler(w[o].handler,this._toolbarContainer,f++,g,w[o].title);if(f)return this._lastButtonIndex=--f,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),c.appendChild(this._toolbarContainer),c.appendChild(this._actionsContainer),c},removeToolbar:function(){for(var s in this._modes)this._modes.hasOwnProperty(s)&&(this._disposeButton(this._modes[s].button,this._modes[s].handler.enable,this._modes[s].handler),this._modes[s].handler.disable(),this._modes[s].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var o=0,c=this._actionButtons.length;o<c;o++)this._disposeButton(this._actionButtons[o].button,this._actionButtons[o].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(s,o,c,f,g){var w=s.type;this._modes[w]={},this._modes[w].handler=s,this._modes[w].button=this._createButton({type:w,title:g,className:f+"-"+w,container:o,callback:this._modes[w].handler.enable,context:this._modes[w].handler}),this._modes[w].buttonIndex=c,this._modes[w].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!D.MSStream},_createButton:function(s){var o=L.DomUtil.create("a",s.className||"",s.container),c=L.DomUtil.create("span","sr-only",s.container);o.href="#",o.appendChild(c),s.title&&(o.title=s.title,c.innerHTML=s.title),s.text&&(o.innerHTML=s.text,c.innerHTML=s.text);var f=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(o,"click",L.DomEvent.stopPropagation).on(o,"mousedown",L.DomEvent.stopPropagation).on(o,"dblclick",L.DomEvent.stopPropagation).on(o,"touchstart",L.DomEvent.stopPropagation).on(o,"click",L.DomEvent.preventDefault).on(o,f,s.callback,s.context),o},_disposeButton:function(s,o){var c=this._detectIOS()?"touchstart":"click";L.DomEvent.off(s,"click",L.DomEvent.stopPropagation).off(s,"mousedown",L.DomEvent.stopPropagation).off(s,"dblclick",L.DomEvent.stopPropagation).off(s,"touchstart",L.DomEvent.stopPropagation).off(s,"click",L.DomEvent.preventDefault).off(s,c,o)},_handlerActivated:function(s){this.disable(),this._activeMode=this._modes[s.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(s){var o,c,f,g,w=this._actionsContainer,T=this.getActions(s),I=T.length;for(c=0,f=this._actionButtons.length;c<f;c++)this._disposeButton(this._actionButtons[c].button,this._actionButtons[c].callback);for(this._actionButtons=[];w.firstChild;)w.removeChild(w.firstChild);for(var H=0;H<I;H++)"enabled"in T[H]&&!T[H].enabled||(o=L.DomUtil.create("li","",w),g=this._createButton({title:T[H].title,text:T[H].text,container:o,callback:T[H].callback,context:T[H].context}),this._actionButtons.push({button:g,callback:T[H].callback}))},_showActionsToolbar:function(){var s=this._activeMode.buttonIndex,o=this._lastButtonIndex,c=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=c+"px",0===s&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),s===o&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(s){this._map=s,this._popupPane=s._panes.popupPane,this._visible=!1,this._container=s.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(s){return this._container?(s.subtext=s.subtext||"",0!==s.subtext.length||this._singleLineLabel?s.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(s.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+s.subtext+"</span><br />":"")+"<span>"+s.text+"</span>",s.text||s.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(s){var o=this._map.latLngToLayerPoint(s),c=this._container;return this._container&&(this._visible&&(c.style.visibility="inherit"),L.DomUtil.setPosition(c,o)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(s){for(var o in this.options)this.options.hasOwnProperty(o)&&s[o]&&(s[o]=L.extend({},this.options[o],s[o]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,s)},getModeHandlers:function(s){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(s,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(s,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(s,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(s,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(s,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(s,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(s){return[{enabled:s.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:s.completeShape,context:s},{enabled:s.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:s.deleteLastVertex,context:s},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(s){for(var o in L.setOptions(this,s),this._modes)this._modes.hasOwnProperty(o)&&s.hasOwnProperty(o)&&this._modes[o].handler.setOptions(s[o])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(s){s.edit&&(void 0===s.edit.selectedPathOptions&&(s.edit.selectedPathOptions=this.options.edit.selectedPathOptions),s.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,s.edit.selectedPathOptions)),s.remove&&(s.remove=L.extend({},this.options.remove,s.remove)),s.poly&&(s.poly=L.extend({},this.options.poly,s.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,s),this._selectedFeatureCount=0},getModeHandlers:function(s){var o=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(s,{featureGroup:o,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(s,{featureGroup:o}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(s){var o=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return s.removeAllLayers&&o.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),o},addToolbar:function(s){var o=L.Toolbar.prototype.addToolbar.call(this,s);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),o},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var s,c=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(s=this._modes[L.EditToolbar.Edit.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(s=this._modes[L.EditToolbar.Delete.TYPE].button,c?L.DomUtil.removeClass(s,"leaflet-disabled"):L.DomUtil.addClass(s,"leaflet-disabled"),s.setAttribute("title",c?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(s,o){if(L.Handler.prototype.initialize.call(this,s),L.setOptions(this,o),this._featureGroup=o.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var c=L.version.split(".");1===parseInt(c[0],10)&&parseInt(c[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),s._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(s){this._revertLayer(s)},this)},save:function(){var s=new L.LayerGroup;this._featureGroup.eachLayer(function(o){o.edited&&(s.addLayer(o),o.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:s})},_backupLayer:function(s){var o=L.Util.stamp(s);this._uneditedLayerProps[o]||(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?this._uneditedLayerProps[o]={latlngs:L.LatLngUtil.cloneLatLngs(s.getLatLngs())}:s instanceof L.Circle?this._uneditedLayerProps[o]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng()),radius:s.getRadius()}:(s instanceof L.Marker||s instanceof L.CircleMarker)&&(this._uneditedLayerProps[o]={latlng:L.LatLngUtil.cloneLatLng(s.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(s){var o=L.Util.stamp(s);s.edited=!1,this._uneditedLayerProps.hasOwnProperty(o)&&(s instanceof L.Polyline||s instanceof L.Polygon||s instanceof L.Rectangle?s.setLatLngs(this._uneditedLayerProps[o].latlngs):s instanceof L.Circle?(s.setLatLng(this._uneditedLayerProps[o].latlng),s.setRadius(this._uneditedLayerProps[o].radius)):(s instanceof L.Marker||s instanceof L.CircleMarker)&&s.setLatLng(this._uneditedLayerProps[o].latlng),s.fire("revert-edited",{layer:s}))},_enableLayerEdit:function(s){var o,c,f=s.layer||s.target||s;this._backupLayer(f),this.options.poly&&(c=L.Util.extend({},this.options.poly),f.options.poly=c),this.options.selectedPathOptions&&((o=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(o.color=f.options.color,o.fillColor=f.options.fillColor),f.options.original=L.extend({},f.options),f.options.editing=o),f instanceof L.Marker?(f.editing&&f.editing.enable(),f.dragging.enable(),f.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):f.editing.enable()},_disableLayerEdit:function(s){var o=s.layer||s.target||s;o.edited=!1,o.editing&&o.editing.disable(),delete o.options.editing,delete o.options.original,this._selectedPathOptions&&(o instanceof L.Marker?this._toggleMarkerHighlight(o):(o.setStyle(o.options.previousOptions),delete o.options.previousOptions)),o instanceof L.Marker?(o.dragging.disable(),o.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):o.editing.disable()},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_onMarkerDragEnd:function(s){var o=s.target;o.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:o})},_onTouchMove:function(s){var c=this._map.mouseEventToLayerPoint(s.originalEvent.changedTouches[0]),f=this._map.layerPointToLatLng(c);s.target.setLatLng(f)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(s,o){if(L.Handler.prototype.initialize.call(this,s),L.Util.setOptions(this,o),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var c=L.version.split(".");1===parseInt(c[0],10)&&parseInt(c[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var s=this._map;s&&(s.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(s){this._deletableLayers.addLayer(s),s.fire("revert-deleted",{layer:s})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(s){this._removeLayer({layer:s})},this),this.save()},_enableLayerDelete:function(s){(s.layer||s.target||s).on("click",this._removeLayer,this)},_disableLayerDelete:function(s){var o=s.layer||s.target||s;o.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(o)},_removeLayer:function(s){var o=s.layer||s.target||s;this._deletableLayers.removeLayer(o),this._deletedLayers.addLayer(o),o.fire("deleted")},_onMouseMove:function(s){this._tooltip.updatePosition(s.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document),function(D,N,E){"use strict";L.Toolbar2.DrawAction={fromHandler:function(b,s,o){return L.Toolbar2.Action.extend({options:{toolbarIcon:L.extend({},L.Toolbar2.Action.prototype.options.toolbarIcon,s),subToolbar:o||L.Toolbar2.Action.prototype.options.subToolbar},initialize:function(c,f){var g=this;this._handler=new b(c,f),this._handler.on("disabled",function(){g.disable()}),L.Toolbar2.Action.prototype.initialize.call(this,f)},enable:function(c){this._handler.enable(),L.Toolbar2.Action.prototype.enable.call(this,c)},disable:function(){this._handler.disable(),L.Toolbar2.Action.prototype.disable.call(this)},setOptions:function(c){this._handler.setOptions(c),L.Toolbar2.Action.prototype.setOptions.call(this,c)}})}},L.Toolbar2.DrawAction.Cancel=L.Toolbar2.Action.extend({options:{toolbarIcon:{html:"Cancel"}},initialize:function(b,s){this.drawing=s,L.Toolbar2.Action.prototype.initialize.call(this)},addHooks:function(){this.drawing.disable(),this.disable()}}),L.Toolbar2.DrawAction.RemoveLastPoint=L.Toolbar2.Action.extend({options:{toolbarIcon:{html:L.drawLocal.draw.toolbar.undo.text}},initialize:function(b,s){this.drawing=s,L.Toolbar2.Action.prototype.initialize.call(this)},addHooks:function(){this.drawing.deleteLastVertex(),this.disable()}}),L.Toolbar2.DrawAction.Circle=L.Toolbar2.DrawAction.fromHandler(L.Draw.Circle,{className:"leaflet-draw-draw-circle",tooltip:L.drawLocal.draw.toolbar.buttons.circle},new L.Toolbar2({actions:[L.Toolbar2.DrawAction.Cancel]})),L.Toolbar2.DrawAction.Marker=L.Toolbar2.DrawAction.fromHandler(L.Draw.Marker,{className:"leaflet-draw-draw-marker",tooltip:L.drawLocal.draw.toolbar.buttons.marker},new L.Toolbar2({actions:[L.Toolbar2.DrawAction.Cancel]})),L.Toolbar2.DrawAction.Polygon=L.Toolbar2.DrawAction.fromHandler(L.Draw.Polygon,{className:"leaflet-draw-draw-polygon",tooltip:L.drawLocal.draw.toolbar.buttons.polygon},new L.Toolbar2({actions:[L.Toolbar2.DrawAction.Cancel,L.Toolbar2.DrawAction.RemoveLastPoint]})),L.Toolbar2.DrawAction.Polygon.prototype.deleteLastVertex=function(){this._handler.deleteLastVertex()},L.Toolbar2.DrawAction.Polyline=L.Toolbar2.DrawAction.fromHandler(L.Draw.Polyline,{className:"leaflet-draw-draw-polyline",tooltip:L.drawLocal.draw.toolbar.buttons.polyline},new L.Toolbar2({actions:[L.Toolbar2.DrawAction.Cancel,L.Toolbar2.DrawAction.RemoveLastPoint]})),L.Toolbar2.DrawAction.Polyline.prototype.deleteLastVertex=function(){this._handler.deleteLastVertex()},L.Toolbar2.DrawAction.Rectangle=L.Toolbar2.DrawAction.fromHandler(L.Draw.Rectangle,{className:"leaflet-draw-draw-rectangle",tooltip:L.drawLocal.draw.toolbar.buttons.rectangle},new L.Toolbar2({actions:[L.Toolbar2.DrawAction.Cancel]})),L.Toolbar2.DrawToolbar=L.Toolbar2.Control.extend({options:{actions:[L.Toolbar2.DrawAction.Polygon,L.Toolbar2.DrawAction.Polyline,L.Toolbar2.DrawAction.Marker,L.Toolbar2.DrawAction.Rectangle,L.Toolbar2.DrawAction.Circle],className:"leaflet-draw-toolbar"}}),L.Toolbar2.EditToolbar={},L.Toolbar2.EditAction={fromHandler:function(b,s,o){return L.Toolbar2.Action.extend({options:{toolbarIcon:L.extend({},L.Toolbar2.Action.prototype.options.toolbarIcon,s),subToolbar:o||L.Toolbar2.Action.prototype.options.subToolbar},initialize:function(c,f,g){var w=this;(g=g||{}).featureGroup=f,this._handler=new b(c,g),this._handler.on("disabled",function(){w.disable()}),L.Toolbar2.Action.prototype.initialize.call(this,g)},enable:function(c){this._handler.enable(),L.Toolbar2.Action.prototype.enable.call(this,c)},disable:function(){this._handler.disable(),L.Toolbar2.Action.prototype.disable.call(this)},setOptions:function(c){this._handler.setOptions(c),L.Toolbar2.Action.prototype.setOptions.call(this,c)},revertLayers:function(){this._handler.revertLayers()},save:function(){this._handler.save()}})}},L.Toolbar2.EditAction.Control={},L.Toolbar2.EditAction.Control.Save=L.Toolbar2.Action.extend({options:{toolbarIcon:{html:"Save"}},initialize:function(b,s,o){this.editing=o,L.Toolbar2.Action.prototype.initialize.call(this)},addHooks:function(){this.editing.save(),this.editing.disable()}}),L.Toolbar2.EditAction.Control.Undo=L.Toolbar2.Action.extend({options:{toolbarIcon:{html:"Undo"}},initialize:function(b,s,o){this.editing=o,L.Toolbar2.Action.prototype.initialize.call(this)},addHooks:function(){this.editing.revertLayers(),this.editing.disable()}}),L.Toolbar2.EditAction.Control.Edit=L.Toolbar2.EditAction.fromHandler(L.EditToolbar.Edit,{className:"leaflet-draw-edit-edit",tooltip:"Edit features"},new L.Toolbar2({actions:[L.Toolbar2.EditAction.Control.Save,L.Toolbar2.EditAction.Control.Undo]})),L.Toolbar2.EditAction.Control.Delete=L.Toolbar2.EditAction.fromHandler(L.EditToolbar.Delete,{className:"leaflet-draw-edit-remove",tooltip:"Remove features"},new L.Toolbar2({actions:[L.Toolbar2.EditAction.Control.Save,L.Toolbar2.EditAction.Control.Undo]})),L.Toolbar2.EditToolbar.Control=L.Toolbar2.Control.extend({options:{actions:[L.Toolbar2.EditAction.Control.Edit,L.Toolbar2.EditAction.Control.Delete],className:"leaflet-draw-toolbar"}}),L.Toolbar2.EditAction.Popup={},L.Toolbar2.EditAction.Popup.Edit=L.Toolbar2.Action.extend({options:{toolbarIcon:{className:"leaflet-draw-edit-edit"}},initialize:function(b,s,o){this._map=b,this._shape=s,this._shape.options.editing=this._shape.options.editing||{},L.Toolbar2.Action.prototype.initialize.call(this,b,o)},enable:function(){var b=this._map,s=this._shape;s.editing.enable(),b.removeLayer(this.toolbar),b.on("click",function(){this.save(),s.editing.disable()},this)},save:function(){var s=this._shape;s.edited&&this._map.fire(L.Draw.Event.EDITED,{layers:L.layerGroup([s])}),s.edited=!1}}),L.Toolbar2.EditAction.Popup.Delete=L.Toolbar2.Action.extend({options:{toolbarIcon:{className:"leaflet-draw-edit-remove"}},initialize:function(b,s,o){this._map=b,this._shape=s,L.Toolbar2.Action.prototype.initialize.call(this,b,o)},addHooks:function(){var b=this._map;b.removeLayer(this._shape),b.removeLayer(this.toolbar),console.log("firing draw:deleted"),b.fire(L.Draw.Event.DELETED,{layers:L.layerGroup([this._shape])})}}),L.Toolbar2.EditToolbar.Popup=L.Toolbar2.Popup.extend({options:{actions:[L.Toolbar2.EditAction.Popup.Edit,L.Toolbar2.EditAction.Popup.Delete],className:"leaflet-draw-toolbar"},onAdd:function(b){var s=this._arguments[1];s instanceof L.Marker&&(this.options.anchor=L.point(s.options.icon.options.popupAnchor)),L.Toolbar2.Popup.prototype.onAdd.call(this,b)}})}(window,document);